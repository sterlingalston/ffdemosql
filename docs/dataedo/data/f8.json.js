window.repositoryObject = {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f8","name":"cdc.fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [TRANSACTION_ID], NULL as [INSTITUTION_ID], NULL as [NETWORK_ID], NULL as [TRANSACTION_NUMBER], NULL as [PAYMENT_TYPE], NULL as [DEBIT_ACCOUNT_ID], NULL as [CREDIT_ACCOUNT_ID], NULL as [EXTERNAL_ACCOUNT_NUMBER], NULL as [EXTERNAL_ROUTING_NUMBER], NULL as [EXTERNAL_BANK_NAME], NULL as [AMOUNT], NULL as [CURRENCY], NULL as [TRANSACTION_DATE], NULL as [EFFECTIVE_DATE], NULL as [SETTLEMENT_DATE], NULL as [STATUS], NULL as [STATUS_REASON], NULL as [DESCRIPTION], NULL as [REFERENCE], NULL as [PROCESSING_FEE], NULL as [RISK_SCORE], NULL as [FRAUD_FLAG], NULL as [COMPLIANCE_FLAG], NULL as [CREATED_DATE], NULL as [MODIFIED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_219BB418\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [TRANSACTION_ID], [INSTITUTION_ID], [NETWORK_ID], [TRANSACTION_NUMBER], [PAYMENT_TYPE], [DEBIT_ACCOUNT_ID], [CREDIT_ACCOUNT_ID], [EXTERNAL_ACCOUNT_NUMBER], [EXTERNAL_ROUTING_NUMBER], [EXTERNAL_BANK_NAME], [AMOUNT], [CURRENCY], [TRANSACTION_DATE], [EFFECTIVE_DATE], [SETTLEMENT_DATE], [STATUS], [STATUS_REASON], [DESCRIPTION], [REFERENCE], [PROCESSING_FEE], [RISK_SCORE], [FRAUD_FLAG], [COMPLIANCE_FLAG], [CREATED_DATE], [MODIFIED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_219BB418 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_219BB418, __$count_219BB418, t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE] \r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[TRANSACTION_ID],\r\n\t\t    count(*) as __$count_219BB418 \r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[TRANSACTION_ID] = m.[TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_219BB418\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_219BB418\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [TRANSACTION_ID], [INSTITUTION_ID], [NETWORK_ID], [TRANSACTION_NUMBER], [PAYMENT_TYPE], [DEBIT_ACCOUNT_ID], [CREDIT_ACCOUNT_ID], [EXTERNAL_ACCOUNT_NUMBER], [EXTERNAL_ROUTING_NUMBER], [EXTERNAL_BANK_NAME], [AMOUNT], [CURRENCY], [TRANSACTION_DATE], [EFFECTIVE_DATE], [SETTLEMENT_DATE], [STATUS], [STATUS_REASON], [DESCRIPTION], [REFERENCE], [PROCESSING_FEE], [RISK_SCORE], [FRAUD_FLAG], [COMPLIANCE_FLAG], [CREATED_DATE], [MODIFIED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_219BB418 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_219BB418, __$count_219BB418, \r\n\t\tm.__$update_mask , t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[TRANSACTION_ID],\r\n\t\t    count(*) as __$count_219BB418, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[TRANSACTION_ID] = m.[TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"};