window.repositoryObject = {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-288","object_id":"column-288","name":"CARD_TRANSACTION_ID","name_without_path":"CARD_TRANSACTION_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-287","object_id":"column-287","name":"CARD_ACCOUNT_ID","name_without_path":"CARD_ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t12","name":"CARDS.CARD_ACCOUNTS","name_show_schema":"CARDS.CARD_ACCOUNTS"}],"linked_lookup":null},{"id":"column-286","object_id":"column-286","name":"TRANSACTION_TYPE","name_without_path":"TRANSACTION_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-285","object_id":"column-285","name":"AMOUNT","name_without_path":"AMOUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-284","object_id":"column-284","name":"CURRENCY","name_without_path":"CURRENCY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"3","is_nullable":true,"computed_formula":null,"default_value":"'USD'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-283","object_id":"column-283","name":"MERCHANT_NAME","name_without_path":"MERCHANT_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-282","object_id":"column-282","name":"MERCHANT_CATEGORY","name_without_path":"MERCHANT_CATEGORY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-281","object_id":"column-281","name":"MERCHANT_ID","name_without_path":"MERCHANT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-280","object_id":"column-280","name":"TRANSACTION_DATE","name_without_path":"TRANSACTION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-279","object_id":"column-279","name":"POSTING_DATE","name_without_path":"POSTING_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-278","object_id":"column-278","name":"AUTHORIZATION_CODE","name_without_path":"AUTHORIZATION_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-277","object_id":"column-277","name":"NETWORK_TRANSACTION_ID","name_without_path":"NETWORK_TRANSACTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-276","object_id":"column-276","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Pending'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-275","object_id":"column-275","name":"DECLINE_REASON","name_without_path":"DECLINE_REASON","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-274","object_id":"column-274","name":"LOCATION","name_without_path":"LOCATION","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-273","object_id":"column-273","name":"COUNTRY","name_without_path":"COUNTRY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-272","object_id":"column-272","name":"RISK_SCORE","name_without_path":"RISK_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-271","object_id":"column-271","name":"FRAUD_FLAG","name_without_path":"FRAUD_FLAG","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-270","object_id":"column-270","name":"REWARDS_EARNED","name_without_path":"REWARDS_EARNED","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-269","object_id":"column-269","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_CARD_TRANSACTIONS_CARD_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_TRANSACTIONS","foreign_table_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_object_id":"t10","primary_table":"CARDS.CARD_ACCOUNTS","primary_table_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_verbose":"CARDS.CARD_ACCOUNTS","primary_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_object_id":"t12","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CARD_ACCOUNT_ID","foreign_column_path":null,"foreign_column":"CARD_ACCOUNT_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_CARD_TRANSACTIONS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"CARD_TRANSACTION_ID","name":"CARD_TRANSACTION_ID","column_id":288}],"custom_fields":{}}],"triggers":[{"name":"TR_CARD_TRANSACTIONS_CHANGE","description":null,"action":"After Insert Update ","script":"-- High-priority trigger for CARDS.CARD_TRANSACTIONS (fraud detection)\r\nCREATE   TRIGGER TR_CARD_TRANSACTIONS_CHANGE\r\nON CARDS.CARD_TRANSACTIONS\r\nAFTER INSERT, UPDATE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @operation_type NVARCHAR(10) = CASE \r\n        WHEN EXISTS(SELECT * FROM deleted) THEN 'UPDATE' \r\n        ELSE 'INSERT' \r\n    END;\r\n    \r\n    IF @operation_type = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'CARDS', 'CARD_TRANSACTIONS', 'INSERT',\r\n            CAST(CARD_TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN FRAUD_FLAG = 1 OR AMOUNT >= 5000 THEN 'HIGH'\r\n                WHEN AMOUNT >= 500 THEN 'MEDIUM'\r\n                ELSE 'LOW'\r\n            END,\r\n            (SELECT \r\n                outer_ins.CARD_TRANSACTION_ID,\r\n                outer_ins.CARD_ACCOUNT_ID,\r\n                outer_ins.TRANSACTION_TYPE,\r\n                outer_ins.AMOUNT,\r\n                outer_ins.MERCHANT_NAME,\r\n                outer_ins.TRANSACTION_DATE,\r\n                outer_ins.STATUS,\r\n                outer_ins.FRAUD_FLAG,\r\n                outer_ins.RISK_SCORE\r\n             FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n        FROM inserted outer_ins;\r\n    END\r\n    ELSE\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'CARDS', 'CARD_TRANSACTIONS', 'UPDATE',\r\n            CAST(i.CARD_TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(i.TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN i.FRAUD_FLAG = 1 OR i.AMOUNT >= 5000 THEN 'HIGH'\r\n                WHEN i.AMOUNT >= 500 THEN 'MEDIUM'\r\n                ELSE 'LOW'\r\n            END,\r\n            CONCAT(\r\n                '{\"operation\":\"UPDATE\",\"old_values\":',\r\n                (SELECT \r\n                    d.CARD_TRANSACTION_ID,\r\n                    d.STATUS,\r\n                    d.AMOUNT,\r\n                    d.FRAUD_FLAG\r\n                 FROM deleted d \r\n                 WHERE d.CARD_TRANSACTION_ID = i.CARD_TRANSACTION_ID \r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                ',\"new_values\":',\r\n                (SELECT \r\n                    i.CARD_TRANSACTION_ID,\r\n                    i.STATUS,\r\n                    i.AMOUNT,\r\n                    i.FRAUD_FLAG\r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                '}'\r\n            )\r\n        FROM inserted i;\r\n    END\r\nEND;","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CARDS.CARD_TRANSACTIONS","object_name_show_schema":"CARDS.CARD_TRANSACTIONS","object_type":"TABLE","object_id":"t10","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"CARDS.TR_CARD_TRANSACTIONS_CHANGE","object_name_show_schema":"CARDS.TR_CARD_TRANSACTIONS_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[]},"object_id":"t10","name":"CARDS.CARD_TRANSACTIONS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CARDS"},{"field":"Name","value":"CARD_TRANSACTIONS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"};