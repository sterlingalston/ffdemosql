window.repository = {"title": "db_azure_ff_demo@db-server-ff-demo.database.windows.net","license": "null","license_expires_at": "2025-07-16","exported_at": "2025-07-03 14:49","structure": [{"id": "repository","object_id": "repository","type": "repository","name": "Repository","subtype": null,"is_user_defined": false,"children": [{"id": "repositoryd","object_id": "repositoryd","type": "data_sources","name": "Data Sources","subtype": null,"is_user_defined": false,"children": [{"id": "d1","object_id": "d1","type": "documentation","name": "db_azure_ff_demo@db-server-ff-demo.database.windows.net","subtype": null,"is_user_defined": false,"children": [{"id": "d1t","object_id": "d1t","type": "tables","name": "Tables","subtype": null,"is_user_defined": false,"children": [{"id": "t2","object_id": "t2","type": "table","name": "ADF_CONTROL.CHANGE_LOG","subtype": "TABLE","is_user_defined": false,"columns": ["LOG_ID","TABLE_SCHEMA","TABLE_NAME","OPERATION_TYPE","RECORD_ID","BUSINESS_DATE","PRIORITY_LEVEL","CHANGE_DATA","PROCESSING_STATUS","ADF_PIPELINE_TRIGGERED","CHANGE_TIMESTAMP","PROCESSED_TIMESTAMP"],},{"id": "t4","object_id": "t4","type": "table","name": "ADF_CONTROL.TABLE_WATERMARKS","subtype": "TABLE","is_user_defined": false,"columns": ["TABLE_SCHEMA","TABLE_NAME","WATERMARK_COLUMN","WATERMARK_VALUE","LAST_UPDATED"],},{"id": "t13","object_id": "t13","type": "table","name": "ANALYTICS.DAILY_METRICS","subtype": "TABLE","is_user_defined": false,"columns": ["METRIC_ID","INSTITUTION_ID","METRIC_DATE","TOTAL_TRANSACTIONS","TOTAL_TRANSACTION_VOLUME","TOTAL_CUSTOMERS","NEW_CUSTOMERS","ACTIVE_DIGITAL_USERS","TOTAL_DEPOSITS","TOTAL_LOANS","FRAUD_DETECTED_COUNT","FRAUD_LOSS_AMOUNT","COMPLIANCE_ALERTS","SYSTEM_UPTIME","CREATED_DATE"],},{"id": "t12","object_id": "t12","type": "table","name": "CARDS.CARD_ACCOUNTS","subtype": "TABLE","is_user_defined": false,"columns": ["CARD_ACCOUNT_ID","INSTITUTION_ID","CUSTOMER_ID","PROGRAM_ID","LINKED_ACCOUNT_ID","CARD_NUMBER_ENCRYPTED","CARD_NUMBER_MASKED","EXPIRATION_DATE","CVV_ENCRYPTED","CARD_HOLDER_NAME","CREDIT_LIMIT","AVAILABLE_CREDIT","CURRENT_BALANCE","MINIMUM_PAYMENT","LAST_PAYMENT_DATE","NEXT_PAYMENT_DUE","STATUS","ISSUE_DATE","ACTIVATION_DATE","BLOCK_REASON","CREATED_DATE"],},{"id": "t5","object_id": "t5","type": "table","name": "CARDS.CARD_PROGRAMS","subtype": "TABLE","is_user_defined": false,"columns": ["PROGRAM_ID","PROGRAM_CODE","PROGRAM_NAME","CARD_TYPE","CARD_NETWORK","BIN","ANNUAL_FEE","INTEREST_RATE","CASH_ADVANCE_FEE","FOREIGN_TRANSACTION_FEE","REWARDS_PROGRAM","IS_ACTIVE"],},{"id": "t10","object_id": "t10","type": "table","name": "CARDS.CARD_TRANSACTIONS","subtype": "TABLE","is_user_defined": false,"columns": ["CARD_TRANSACTION_ID","CARD_ACCOUNT_ID","TRANSACTION_TYPE","AMOUNT","CURRENCY","MERCHANT_NAME","MERCHANT_CATEGORY","MERCHANT_ID","TRANSACTION_DATE","POSTING_DATE","AUTHORIZATION_CODE","NETWORK_TRANSACTION_ID","STATUS","DECLINE_REASON","LOCATION","COUNTRY","RISK_SCORE","FRAUD_FLAG","REWARDS_EARNED","CREATED_DATE"],},{"id": "t20","object_id": "t20","type": "table","name": "cdc.EventLog","subtype": "TABLE","is_user_defined": false,"columns": ["EventID","TableName","Operation","RecordID","OldValues","NewValues","ChangeDate","Processed","ProcessedDate"],},{"id": "t1","object_id": "t1","type": "table","name": "COMPLIANCE.REGULATORY_REPORTS","subtype": "TABLE","is_user_defined": false,"columns": ["REPORT_ID","INSTITUTION_ID","REPORT_TYPE","REPORTING_PERIOD","REGULATOR_ID","STATUS","SUBMISSION_DATE","DUE_DATE","FILE_PATH","CREATED_DATE"],},{"id": "t19","object_id": "t19","type": "table","name": "COMPLIANCE.SANCTIONS_SCREENING","subtype": "TABLE","is_user_defined": false,"columns": ["SCREENING_ID","CUSTOMER_ID","TRANSACTION_ID","ENTITY_NAME","SCREENING_TYPE","MATCH_TYPE","MATCH_SCORE","LIST_NAME","STATUS","REVIEW_NOTES","SCREENING_DATE","REVIEWED_BY","REVIEWED_DATE"],},{"id": "t18","object_id": "t18","type": "table","name": "CORE.ACCOUNTS","subtype": "TABLE","is_user_defined": false,"columns": ["ACCOUNT_ID","INSTITUTION_ID","CUSTOMER_ID","PRODUCT_TYPE_ID","ACCOUNT_NUMBER","ACCOUNT_NAME","CURRENT_BALANCE","AVAILABLE_BALANCE","PENDING_BALANCE","OVERDRAFT_LIMIT","INTEREST_RATE","OPEN_DATE","LAST_TRANSACTION_DATE","STATUS","CLOSE_DATE","CLOSE_REASON","CREATED_DATE"],},{"id": "t11","object_id": "t11","type": "table","name": "CORE.CUSTOMERS","subtype": "TABLE","is_user_defined": false,"columns": ["CUSTOMER_ID","INSTITUTION_ID","CUSTOMER_NUMBER","CUSTOMER_TYPE","FIRST_NAME","LAST_NAME","BUSINESS_NAME","DATE_OF_BIRTH","SSN_ENCRYPTED","EIN_ENCRYPTED","EMAIL","PHONE","ADDRESS","CITY","STATE","ZIP_CODE","CREDIT_SCORE","RISK_RATING","KYC_STATUS","CUSTOMER_SINCE","LAST_LOGIN_DATE","STATUS","CREATED_DATE"],},{"id": "t7","object_id": "t7","type": "table","name": "CORE.FINANCIAL_INSTITUTIONS","subtype": "TABLE","is_user_defined": false,"columns": ["INSTITUTION_ID","INSTITUTION_CODE","INSTITUTION_NAME","INSTITUTION_TYPE","ROUTING_NUMBER","SWIFT_CODE","ADDRESS","CITY","STATE","ZIP_CODE","COUNTRY","REGULATION_LEVEL","ASSETS_UNDER_MANAGEMENT","CUSTOMER_COUNT","PLATFORM_ONBOARD_DATE","STATUS","CREATED_DATE"],},{"id": "t9","object_id": "t9","type": "table","name": "CORE.PRODUCT_TYPES","subtype": "TABLE","is_user_defined": false,"columns": ["PRODUCT_TYPE_ID","PRODUCT_CODE","PRODUCT_NAME","PRODUCT_CATEGORY","INTEREST_RATE","MINIMUM_BALANCE","MONTHLY_FEE","OVERDRAFT_FEE","IS_ACTIVE"],},{"id": "t17","object_id": "t17","type": "table","name": "dbo.EventLog","subtype": "TABLE","is_user_defined": false,"columns": ["EventID","TableName","SchemaName","Operation","RecordID","OldValues","NewValues","ChangeDate","ChangedBy","Processed","ProcessedDate"],},{"id": "t15","object_id": "t15","type": "table","name": "DIGITAL.BILL_PAY_PAYEES","subtype": "TABLE","is_user_defined": false,"columns": ["PAYEE_ID","CUSTOMER_ID","PAYEE_NAME","PAYEE_TYPE","ACCOUNT_NUMBER","ADDRESS","CITY","STATE","ZIP_CODE","PHONE","IS_ACTIVE","CREATED_DATE"],},{"id": "t16","object_id": "t16","type": "table","name": "DIGITAL.DIGITAL_USERS","subtype": "TABLE","is_user_defined": false,"columns": ["USER_ID","CUSTOMER_ID","USERNAME","PASSWORD_HASH","EMAIL","MOBILE_PHONE","LAST_LOGIN_DATE","LOGIN_ATTEMPTS","IS_LOCKED","LOCKOUT_END_DATE","TWO_FACTOR_ENABLED","PREFERRED_NOTIFICATION_METHOD","STATUS","CREATED_DATE"],},{"id": "t3","object_id": "t3","type": "table","name": "DIGITAL.USER_SESSIONS","subtype": "TABLE","is_user_defined": false,"columns": ["SESSION_ID","USER_ID","SESSION_TOKEN","DEVICE_TYPE","DEVICE_ID","IP_ADDRESS","USER_AGENT","START_TIME","LAST_ACTIVITY","END_TIME","STATUS"],},{"id": "t21","object_id": "t21","type": "table","name": "PAYMENTS.PAYMENT_NETWORKS","subtype": "TABLE","is_user_defined": false,"columns": ["NETWORK_ID","NETWORK_CODE","NETWORK_NAME","NETWORK_TYPE","PROCESSING_FEE","SETTLEMENT_TIME","MAX_TRANSACTION_AMOUNT","IS_ACTIVE"],},{"id": "t6","object_id": "t6","type": "table","name": "PAYMENTS.TRANSACTIONS","subtype": "TABLE","is_user_defined": false,"columns": ["TRANSACTION_ID","INSTITUTION_ID","NETWORK_ID","TRANSACTION_NUMBER","PAYMENT_TYPE","DEBIT_ACCOUNT_ID","CREDIT_ACCOUNT_ID","EXTERNAL_ACCOUNT_NUMBER","EXTERNAL_ROUTING_NUMBER","EXTERNAL_BANK_NAME","AMOUNT","CURRENCY","TRANSACTION_DATE","EFFECTIVE_DATE","SETTLEMENT_DATE","STATUS","STATUS_REASON","DESCRIPTION","REFERENCE","PROCESSING_FEE","RISK_SCORE","FRAUD_FLAG","COMPLIANCE_FLAG","CREATED_DATE","MODIFIED_DATE"],},{"id": "t14","object_id": "t14","type": "table","name": "RISK.RISK_EVENTS","subtype": "TABLE","is_user_defined": false,"columns": ["EVENT_ID","RULE_ID","INSTITUTION_ID","CUSTOMER_ID","ACCOUNT_ID","TRANSACTION_ID","CARD_TRANSACTION_ID","EVENT_TYPE","EVENT_DESCRIPTION","RISK_SCORE","SEVERITY","STATUS","ASSIGNED_TO","RESOLUTION_NOTES","EVENT_DATE","RESOLVED_DATE"],},{"id": "t8","object_id": "t8","type": "table","name": "RISK.RISK_RULES","subtype": "TABLE","is_user_defined": false,"columns": ["RULE_ID","RULE_NAME","RULE_TYPE","RULE_DESCRIPTION","RISK_SCORE","SEVERITY","IS_ACTIVE","CREATED_DATE"],},]},{"id": "d1f","object_id": "d1f","type": "functions","name": "Functions","subtype": null,"is_user_defined": false,"children": [{"id": "f2","object_id": "f2","type": "function","name": "cdc.fn_cdc_get_all_changes_CARDS_CARD_ACCOUNTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f3","object_id": "f3","type": "function","name": "cdc.fn_cdc_get_all_changes_CARDS_CARD_TRANSACTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f17","object_id": "f17","type": "function","name": "cdc.fn_cdc_get_all_changes_COMPLIANCE_REGULATORY_REPORTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f4","object_id": "f4","type": "function","name": "cdc.fn_cdc_get_all_changes_COMPLIANCE_SANCTIONS_SCREENING","subtype": "FUNCTION","is_user_defined": false,},{"id": "f9","object_id": "f9","type": "function","name": "cdc.fn_cdc_get_all_changes_CORE_ACCOUNTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f22","object_id": "f22","type": "function","name": "cdc.fn_cdc_get_all_changes_CORE_CUSTOMERS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f15","object_id": "f15","type": "function","name": "cdc.fn_cdc_get_all_changes_CORE_FINANCIAL_INSTITUTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f20","object_id": "f20","type": "function","name": "cdc.fn_cdc_get_all_changes_CORE_PRODUCT_TYPES","subtype": "FUNCTION","is_user_defined": false,},{"id": "f21","object_id": "f21","type": "function","name": "cdc.fn_cdc_get_all_changes_DIGITAL_DIGITAL_USERS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f14","object_id": "f14","type": "function","name": "cdc.fn_cdc_get_all_changes_PAYMENTS_PAYMENT_NETWORKS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f11","object_id": "f11","type": "function","name": "cdc.fn_cdc_get_all_changes_PAYMENTS_TRANSACTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f5","object_id": "f5","type": "function","name": "cdc.fn_cdc_get_all_changes_RISK_RISK_EVENTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f7","object_id": "f7","type": "function","name": "cdc.fn_cdc_get_net_changes_CARDS_CARD_ACCOUNTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f23","object_id": "f23","type": "function","name": "cdc.fn_cdc_get_net_changes_CARDS_CARD_TRANSACTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f1","object_id": "f1","type": "function","name": "cdc.fn_cdc_get_net_changes_COMPLIANCE_REGULATORY_REPORTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f12","object_id": "f12","type": "function","name": "cdc.fn_cdc_get_net_changes_COMPLIANCE_SANCTIONS_SCREENING","subtype": "FUNCTION","is_user_defined": false,},{"id": "f16","object_id": "f16","type": "function","name": "cdc.fn_cdc_get_net_changes_CORE_ACCOUNTS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f19","object_id": "f19","type": "function","name": "cdc.fn_cdc_get_net_changes_CORE_CUSTOMERS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f18","object_id": "f18","type": "function","name": "cdc.fn_cdc_get_net_changes_CORE_FINANCIAL_INSTITUTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f24","object_id": "f24","type": "function","name": "cdc.fn_cdc_get_net_changes_CORE_PRODUCT_TYPES","subtype": "FUNCTION","is_user_defined": false,},{"id": "f6","object_id": "f6","type": "function","name": "cdc.fn_cdc_get_net_changes_DIGITAL_DIGITAL_USERS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f13","object_id": "f13","type": "function","name": "cdc.fn_cdc_get_net_changes_PAYMENTS_PAYMENT_NETWORKS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f8","object_id": "f8","type": "function","name": "cdc.fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS","subtype": "FUNCTION","is_user_defined": false,},{"id": "f10","object_id": "f10","type": "function","name": "cdc.fn_cdc_get_net_changes_RISK_RISK_EVENTS","subtype": "FUNCTION","is_user_defined": false,},]},]},]},]},],"objects": {"repository": {"object_id":"repository","title":"Repository","object_type":"REPOSITORY","DisplayType":"repository","description":"","summary":[{"field":"Type","value":"repository"}]},"t4": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-220","object_id":"column-220","name":"TABLE_SCHEMA","name_without_path":"TABLE_SCHEMA","description":null,"is_pk":true,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-219","object_id":"column-219","name":"TABLE_NAME","name_without_path":"TABLE_NAME","description":null,"is_pk":true,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-218","object_id":"column-218","name":"WATERMARK_COLUMN","name_without_path":"WATERMARK_COLUMN","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-217","object_id":"column-217","name":"WATERMARK_VALUE","name_without_path":"WATERMARK_VALUE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-216","object_id":"column-216","name":"LAST_UPDATED","name_without_path":"LAST_UPDATED","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[],"unique_keys":[{"name":"PK_TABLE_WATERMARKS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"TABLE_SCHEMA","name":"TABLE_SCHEMA","column_id":220},{"path":null,"name_without_path":"TABLE_NAME","name":"TABLE_NAME","column_id":219}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"t4","name":"ADF_CONTROL.TABLE_WATERMARKS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"ADF_CONTROL"},{"field":"Name","value":"TABLE_WATERMARKS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f11": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f11","name":"cdc.fn_cdc_get_all_changes_PAYMENTS_TRANSACTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_PAYMENTS_TRANSACTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_PAYMENTS_TRANSACTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [TRANSACTION_ID], NULL as [INSTITUTION_ID], NULL as [NETWORK_ID], NULL as [TRANSACTION_NUMBER], NULL as [PAYMENT_TYPE], NULL as [DEBIT_ACCOUNT_ID], NULL as [CREDIT_ACCOUNT_ID], NULL as [EXTERNAL_ACCOUNT_NUMBER], NULL as [EXTERNAL_ROUTING_NUMBER], NULL as [EXTERNAL_BANK_NAME], NULL as [AMOUNT], NULL as [CURRENCY], NULL as [TRANSACTION_DATE], NULL as [EFFECTIVE_DATE], NULL as [SETTLEMENT_DATE], NULL as [STATUS], NULL as [STATUS_REASON], NULL as [DESCRIPTION], NULL as [REFERENCE], NULL as [PROCESSING_FEE], NULL as [RISK_SCORE], NULL as [FRAUD_FLAG], NULL as [COMPLIANCE_FLAG], NULL as [CREATED_DATE], NULL as [MODIFIED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"f9": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f9","name":"cdc.fn_cdc_get_all_changes_CORE_ACCOUNTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CORE_ACCOUNTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CORE_ACCOUNTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [ACCOUNT_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [PRODUCT_TYPE_ID], NULL as [ACCOUNT_NUMBER], NULL as [ACCOUNT_NAME], NULL as [CURRENT_BALANCE], NULL as [AVAILABLE_BALANCE], NULL as [PENDING_BALANCE], NULL as [OVERDRAFT_LIMIT], NULL as [INTEREST_RATE], NULL as [OPEN_DATE], NULL as [LAST_TRANSACTION_DATE], NULL as [STATUS], NULL as [CLOSE_DATE], NULL as [CLOSE_REASON], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PRODUCT_TYPE_ID], t.[ACCOUNT_NUMBER], t.[ACCOUNT_NAME], t.[CURRENT_BALANCE], t.[AVAILABLE_BALANCE], t.[PENDING_BALANCE], t.[OVERDRAFT_LIMIT], t.[INTEREST_RATE], t.[OPEN_DATE], t.[LAST_TRANSACTION_DATE], t.[STATUS], t.[CLOSE_DATE], t.[CLOSE_REASON], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_ACCOUNTS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PRODUCT_TYPE_ID], t.[ACCOUNT_NUMBER], t.[ACCOUNT_NAME], t.[CURRENT_BALANCE], t.[AVAILABLE_BALANCE], t.[PENDING_BALANCE], t.[OVERDRAFT_LIMIT], t.[INTEREST_RATE], t.[OPEN_DATE], t.[LAST_TRANSACTION_DATE], t.[STATUS], t.[CLOSE_DATE], t.[CLOSE_REASON], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_ACCOUNTS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"f22": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f22","name":"cdc.fn_cdc_get_all_changes_CORE_CUSTOMERS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CORE_CUSTOMERS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CORE_CUSTOMERS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CUSTOMER_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_NUMBER], NULL as [CUSTOMER_TYPE], NULL as [FIRST_NAME], NULL as [LAST_NAME], NULL as [BUSINESS_NAME], NULL as [DATE_OF_BIRTH], NULL as [SSN_ENCRYPTED], NULL as [EIN_ENCRYPTED], NULL as [EMAIL], NULL as [PHONE], NULL as [ADDRESS], NULL as [CITY], NULL as [STATE], NULL as [ZIP_CODE], NULL as [CREDIT_SCORE], NULL as [RISK_RATING], NULL as [KYC_STATUS], NULL as [CUSTOMER_SINCE], NULL as [LAST_LOGIN_DATE], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CUSTOMER_ID], t.[INSTITUTION_ID], t.[CUSTOMER_NUMBER], t.[CUSTOMER_TYPE], t.[FIRST_NAME], t.[LAST_NAME], t.[BUSINESS_NAME], t.[DATE_OF_BIRTH], t.[SSN_ENCRYPTED], t.[EIN_ENCRYPTED], t.[EMAIL], t.[PHONE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[CREDIT_SCORE], t.[RISK_RATING], t.[KYC_STATUS], t.[CUSTOMER_SINCE], t.[LAST_LOGIN_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_CUSTOMERS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CUSTOMER_ID], t.[INSTITUTION_ID], t.[CUSTOMER_NUMBER], t.[CUSTOMER_TYPE], t.[FIRST_NAME], t.[LAST_NAME], t.[BUSINESS_NAME], t.[DATE_OF_BIRTH], t.[SSN_ENCRYPTED], t.[EIN_ENCRYPTED], t.[EMAIL], t.[PHONE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[CREDIT_SCORE], t.[RISK_RATING], t.[KYC_STATUS], t.[CUSTOMER_SINCE], t.[LAST_LOGIN_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_CUSTOMERS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t17": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-130","object_id":"column-130","name":"EventID","name_without_path":"EventID","description":null,"is_pk":true,"is_identity":true,"data_type":"bigint","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-129","object_id":"column-129","name":"TableName","name_without_path":"TableName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-128","object_id":"column-128","name":"SchemaName","name_without_path":"SchemaName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-127","object_id":"column-127","name":"Operation","name_without_path":"Operation","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"10","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-126","object_id":"column-126","name":"RecordID","name_without_path":"RecordID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-125","object_id":"column-125","name":"OldValues","name_without_path":"OldValues","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"MAX","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-124","object_id":"column-124","name":"NewValues","name_without_path":"NewValues","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"MAX","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-123","object_id":"column-123","name":"ChangeDate","name_without_path":"ChangeDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getutcdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-122","object_id":"column-122","name":"ChangedBy","name_without_path":"ChangedBy","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":true,"computed_formula":null,"default_value":"suser_sname()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-121","object_id":"column-121","name":"Processed","name_without_path":"Processed","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-120","object_id":"column-120","name":"ProcessedDate","name_without_path":"ProcessedDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[],"unique_keys":[{"name":"PK__EventLog__7944C8706A97A16D","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"EventID","name":"EventID","column_id":130}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"t17","name":"dbo.EventLog","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"EventLog"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t1": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-257","object_id":"column-257","name":"REPORT_ID","name_without_path":"REPORT_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-256","object_id":"column-256","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-255","object_id":"column-255","name":"REPORT_TYPE","name_without_path":"REPORT_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-159","object_id":"column-159","name":"REPORTING_PERIOD","name_without_path":"REPORTING_PERIOD","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-158","object_id":"column-158","name":"REGULATOR_ID","name_without_path":"REGULATOR_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-157","object_id":"column-157","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Draft'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-156","object_id":"column-156","name":"SUBMISSION_DATE","name_without_path":"SUBMISSION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-155","object_id":"column-155","name":"DUE_DATE","name_without_path":"DUE_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-154","object_id":"column-154","name":"FILE_PATH","name_without_path":"FILE_PATH","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-153","object_id":"column-153","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_REGULATORY_REPORTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_show_schema":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_verbose":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_verbose_show_schema":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_object_id":"t1","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_REGULATORY_REPORTS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"REPORT_ID","name":"REPORT_ID","column_id":257}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"COMPLIANCE.REGULATORY_REPORTS","object_name_show_schema":"COMPLIANCE.REGULATORY_REPORTS","object_type":"TABLE","object_id":"t1","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[]},"object_id":"t1","name":"COMPLIANCE.REGULATORY_REPORTS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"COMPLIANCE"},{"field":"Name","value":"REGULATORY_REPORTS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t14": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-195","object_id":"column-195","name":"EVENT_ID","name_without_path":"EVENT_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-194","object_id":"column-194","name":"RULE_ID","name_without_path":"RULE_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t8","name":"RISK.RISK_RULES","name_show_schema":"RISK.RISK_RULES"}],"linked_lookup":null},{"id":"column-193","object_id":"column-193","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-192","object_id":"column-192","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-191","object_id":"column-191","name":"ACCOUNT_ID","name_without_path":"ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-190","object_id":"column-190","name":"TRANSACTION_ID","name_without_path":"TRANSACTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-189","object_id":"column-189","name":"CARD_TRANSACTION_ID","name_without_path":"CARD_TRANSACTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-188","object_id":"column-188","name":"EVENT_TYPE","name_without_path":"EVENT_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-187","object_id":"column-187","name":"EVENT_DESCRIPTION","name_without_path":"EVENT_DESCRIPTION","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-186","object_id":"column-186","name":"RISK_SCORE","name_without_path":"RISK_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-42","object_id":"column-42","name":"SEVERITY","name_without_path":"SEVERITY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-41","object_id":"column-41","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Open'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-40","object_id":"column-40","name":"ASSIGNED_TO","name_without_path":"ASSIGNED_TO","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-254","object_id":"column-254","name":"RESOLUTION_NOTES","name_without_path":"RESOLUTION_NOTES","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"1000","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-253","object_id":"column-253","name":"EVENT_DATE","name_without_path":"EVENT_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-252","object_id":"column-252","name":"RESOLVED_DATE","name_without_path":"RESOLVED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_RISK_EVENTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_RISK_EVENTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_RISK_EVENTS_RULE","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"RISK.RISK_RULES","primary_table_show_schema":"RISK.RISK_RULES","primary_table_verbose":"RISK.RISK_RULES","primary_table_verbose_show_schema":"RISK.RISK_RULES","primary_table_object_id":"t8","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"RULE_ID","foreign_column_path":null,"foreign_column":"RULE_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_RISK_EVENTS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"EVENT_ID","name":"EVENT_ID","column_id":195}],"custom_fields":{}}],"triggers":[{"name":"TR_RISK_EVENTS_CHANGE","description":null,"action":"After Insert Update ","script":"-- Additional trigger for RISK.RISK_EVENTS (for risk management)\r\nCREATE   TRIGGER TR_RISK_EVENTS_CHANGE\r\nON RISK.RISK_EVENTS\r\nAFTER INSERT, UPDATE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @op_type NVARCHAR(10) = CASE \r\n        WHEN EXISTS(SELECT * FROM deleted) THEN 'UPDATE' \r\n        ELSE 'INSERT' \r\n    END;\r\n    \r\n    INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n        TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n        BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n    )\r\n    SELECT \r\n        'RISK', 'RISK_EVENTS', @op_type,\r\n        CAST(EVENT_ID AS NVARCHAR(100)),\r\n        CAST(EVENT_DATE AS DATE),\r\n        CASE \r\n            WHEN SEVERITY = 'Critical' OR RISK_SCORE >= 90 THEN 'HIGH'\r\n            WHEN SEVERITY = 'High' OR RISK_SCORE >= 70 THEN 'MEDIUM'\r\n            ELSE 'LOW'\r\n        END,\r\n        (SELECT \r\n            outer_ins.EVENT_ID,\r\n            outer_ins.RULE_ID,\r\n            outer_ins.INSTITUTION_ID,\r\n            outer_ins.CUSTOMER_ID,\r\n            outer_ins.EVENT_TYPE,\r\n            outer_ins.RISK_SCORE,\r\n            outer_ins.SEVERITY,\r\n            outer_ins.STATUS,\r\n            outer_ins.EVENT_DATE\r\n         FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n    FROM inserted outer_ins;\r\nEND;","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"RISK.RISK_EVENTS","object_name_show_schema":"RISK.RISK_EVENTS","object_type":"TABLE","object_id":"t14","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"RISK.RISK_RULES","object_name_show_schema":"RISK.RISK_RULES","object_type":"TABLE","object_id":"t8","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"RISK.TR_RISK_EVENTS_CHANGE","object_name_show_schema":"RISK.TR_RISK_EVENTS_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[]},"object_id":"t14","name":"RISK.RISK_EVENTS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"RISK"},{"field":"Name","value":"RISK_EVENTS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"repositoryd": {"object_id":"repositoryd","custom_fields":[],"documentations":[{"id":"d1","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","type":"DATABASE","is_user_defined":false,"custom_fields":{"Owner":{"value":"","type":"USER"}}}]},"t13": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-119","object_id":"column-119","name":"METRIC_ID","name_without_path":"METRIC_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-118","object_id":"column-118","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-117","object_id":"column-117","name":"METRIC_DATE","name_without_path":"METRIC_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-116","object_id":"column-116","name":"TOTAL_TRANSACTIONS","name_without_path":"TOTAL_TRANSACTIONS","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-115","object_id":"column-115","name":"TOTAL_TRANSACTION_VOLUME","name_without_path":"TOTAL_TRANSACTION_VOLUME","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"18, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-114","object_id":"column-114","name":"TOTAL_CUSTOMERS","name_without_path":"TOTAL_CUSTOMERS","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-113","object_id":"column-113","name":"NEW_CUSTOMERS","name_without_path":"NEW_CUSTOMERS","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-112","object_id":"column-112","name":"ACTIVE_DIGITAL_USERS","name_without_path":"ACTIVE_DIGITAL_USERS","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-111","object_id":"column-111","name":"TOTAL_DEPOSITS","name_without_path":"TOTAL_DEPOSITS","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"18, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-110","object_id":"column-110","name":"TOTAL_LOANS","name_without_path":"TOTAL_LOANS","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"18, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-109","object_id":"column-109","name":"FRAUD_DETECTED_COUNT","name_without_path":"FRAUD_DETECTED_COUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-108","object_id":"column-108","name":"FRAUD_LOSS_AMOUNT","name_without_path":"FRAUD_LOSS_AMOUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-107","object_id":"column-107","name":"COMPLIANCE_ALERTS","name_without_path":"COMPLIANCE_ALERTS","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-106","object_id":"column-106","name":"SYSTEM_UPTIME","name_without_path":"SYSTEM_UPTIME","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 2","is_nullable":true,"computed_formula":null,"default_value":"100.00","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-105","object_id":"column-105","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_DAILY_METRICS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"ANALYTICS.DAILY_METRICS","foreign_table_show_schema":"ANALYTICS.DAILY_METRICS","foreign_table_verbose":"ANALYTICS.DAILY_METRICS","foreign_table_verbose_show_schema":"ANALYTICS.DAILY_METRICS","foreign_table_object_id":"t13","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_DAILY_METRICS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"METRIC_ID","name":"METRIC_ID","column_id":119}],"custom_fields":{}},{"name":"UQ_DAILY_METRICS_DATE","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_ID","name":"INSTITUTION_ID","column_id":118},{"path":null,"name_without_path":"METRIC_DATE","name":"METRIC_DATE","column_id":117}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"ANALYTICS.DAILY_METRICS","object_name_show_schema":"ANALYTICS.DAILY_METRICS","object_type":"TABLE","object_id":"t13","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[]},"object_id":"t13","name":"ANALYTICS.DAILY_METRICS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"ANALYTICS"},{"field":"Name","value":"DAILY_METRICS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f5": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f5","name":"cdc.fn_cdc_get_all_changes_RISK_RISK_EVENTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_RISK_RISK_EVENTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_RISK_RISK_EVENTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [EVENT_ID], NULL as [RULE_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [ACCOUNT_ID], NULL as [TRANSACTION_ID], NULL as [CARD_TRANSACTION_ID], NULL as [EVENT_TYPE], NULL as [EVENT_DESCRIPTION], NULL as [RISK_SCORE], NULL as [SEVERITY], NULL as [STATUS], NULL as [ASSIGNED_TO], NULL as [RESOLUTION_NOTES], NULL as [EVENT_DATE], NULL as [RESOLVED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[EVENT_ID], t.[RULE_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[ACCOUNT_ID], t.[TRANSACTION_ID], t.[CARD_TRANSACTION_ID], t.[EVENT_TYPE], t.[EVENT_DESCRIPTION], t.[RISK_SCORE], t.[SEVERITY], t.[STATUS], t.[ASSIGNED_TO], t.[RESOLUTION_NOTES], t.[EVENT_DATE], t.[RESOLVED_DATE]\r\n\tfrom [cdc].[RISK_RISK_EVENTS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[EVENT_ID], t.[RULE_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[ACCOUNT_ID], t.[TRANSACTION_ID], t.[CARD_TRANSACTION_ID], t.[EVENT_TYPE], t.[EVENT_DESCRIPTION], t.[RISK_SCORE], t.[SEVERITY], t.[STATUS], t.[ASSIGNED_TO], t.[RESOLUTION_NOTES], t.[EVENT_DATE], t.[RESOLVED_DATE]\r\n\tfrom [cdc].[RISK_RISK_EVENTS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"f16": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f16","name":"cdc.fn_cdc_get_net_changes_CORE_ACCOUNTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CORE_ACCOUNTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CORE_ACCOUNTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [ACCOUNT_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [PRODUCT_TYPE_ID], NULL as [ACCOUNT_NUMBER], NULL as [ACCOUNT_NAME], NULL as [CURRENT_BALANCE], NULL as [AVAILABLE_BALANCE], NULL as [PENDING_BALANCE], NULL as [OVERDRAFT_LIMIT], NULL as [INTEREST_RATE], NULL as [OPEN_DATE], NULL as [LAST_TRANSACTION_DATE], NULL as [STATUS], NULL as [CLOSE_DATE], NULL as [CLOSE_REASON], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_757A5908\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_757A5908 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [ACCOUNT_ID], [INSTITUTION_ID], [CUSTOMER_ID], [PRODUCT_TYPE_ID], [ACCOUNT_NUMBER], [ACCOUNT_NAME], [CURRENT_BALANCE], [AVAILABLE_BALANCE], [PENDING_BALANCE], [OVERDRAFT_LIMIT], [INTEREST_RATE], [OPEN_DATE], [LAST_TRANSACTION_DATE], [STATUS], [CLOSE_DATE], [CLOSE_REASON], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_757A5908 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_757A5908, __$count_757A5908, t.[ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PRODUCT_TYPE_ID], t.[ACCOUNT_NUMBER], t.[ACCOUNT_NAME], t.[CURRENT_BALANCE], t.[AVAILABLE_BALANCE], t.[PENDING_BALANCE], t.[OVERDRAFT_LIMIT], t.[INTEREST_RATE], t.[OPEN_DATE], t.[LAST_TRANSACTION_DATE], t.[STATUS], t.[CLOSE_DATE], t.[CLOSE_REASON], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[CORE_ACCOUNTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[ACCOUNT_ID],\r\n\t\t    count(*) as __$count_757A5908 \r\n\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[ACCOUNT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_ACCOUNTS_CT] c with (nolock) where  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[ACCOUNT_ID] = m.[ACCOUNT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[ACCOUNT_ID] = mo.[ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_757A5908\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_757A5908 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_757A5908\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_757A5908 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [ACCOUNT_ID], [INSTITUTION_ID], [CUSTOMER_ID], [PRODUCT_TYPE_ID], [ACCOUNT_NUMBER], [ACCOUNT_NAME], [CURRENT_BALANCE], [AVAILABLE_BALANCE], [PENDING_BALANCE], [OVERDRAFT_LIMIT], [INTEREST_RATE], [OPEN_DATE], [LAST_TRANSACTION_DATE], [STATUS], [CLOSE_DATE], [CLOSE_REASON], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_757A5908 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_757A5908, __$count_757A5908, \r\n\t\tm.__$update_mask , t.[ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PRODUCT_TYPE_ID], t.[ACCOUNT_NUMBER], t.[ACCOUNT_NAME], t.[CURRENT_BALANCE], t.[AVAILABLE_BALANCE], t.[PENDING_BALANCE], t.[OVERDRAFT_LIMIT], t.[INTEREST_RATE], t.[OPEN_DATE], t.[LAST_TRANSACTION_DATE], t.[STATUS], t.[CLOSE_DATE], t.[CLOSE_REASON], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_ACCOUNTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[ACCOUNT_ID],\r\n\t\t    count(*) as __$count_757A5908, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[ACCOUNT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_ACCOUNTS_CT] c with (nolock) where  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[ACCOUNT_ID] = m.[ACCOUNT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[ACCOUNT_ID] = mo.[ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PRODUCT_TYPE_ID], t.[ACCOUNT_NUMBER], t.[ACCOUNT_NAME], t.[CURRENT_BALANCE], t.[AVAILABLE_BALANCE], t.[PENDING_BALANCE], t.[OVERDRAFT_LIMIT], t.[INTEREST_RATE], t.[OPEN_DATE], t.[LAST_TRANSACTION_DATE], t.[STATUS], t.[CLOSE_DATE], t.[CLOSE_REASON], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_ACCOUNTS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_ACCOUNTS_CT] c with (nolock) where  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_ACCOUNTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[ACCOUNT_ID] = t.[ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[ACCOUNT_ID] = mo.[ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f15": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f15","name":"cdc.fn_cdc_get_all_changes_CORE_FINANCIAL_INSTITUTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CORE_FINANCIAL_INSTITUTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CORE_FINANCIAL_INSTITUTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [INSTITUTION_ID], NULL as [INSTITUTION_CODE], NULL as [INSTITUTION_NAME], NULL as [INSTITUTION_TYPE], NULL as [ROUTING_NUMBER], NULL as [SWIFT_CODE], NULL as [ADDRESS], NULL as [CITY], NULL as [STATE], NULL as [ZIP_CODE], NULL as [COUNTRY], NULL as [REGULATION_LEVEL], NULL as [ASSETS_UNDER_MANAGEMENT], NULL as [CUSTOMER_COUNT], NULL as [PLATFORM_ONBOARD_DATE], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[INSTITUTION_ID], t.[INSTITUTION_CODE], t.[INSTITUTION_NAME], t.[INSTITUTION_TYPE], t.[ROUTING_NUMBER], t.[SWIFT_CODE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[COUNTRY], t.[REGULATION_LEVEL], t.[ASSETS_UNDER_MANAGEMENT], t.[CUSTOMER_COUNT], t.[PLATFORM_ONBOARD_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[INSTITUTION_ID], t.[INSTITUTION_CODE], t.[INSTITUTION_NAME], t.[INSTITUTION_TYPE], t.[ROUTING_NUMBER], t.[SWIFT_CODE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[COUNTRY], t.[REGULATION_LEVEL], t.[ASSETS_UNDER_MANAGEMENT], t.[CUSTOMER_COUNT], t.[PLATFORM_ONBOARD_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t15": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-232","object_id":"column-232","name":"PAYEE_ID","name_without_path":"PAYEE_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-231","object_id":"column-231","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-230","object_id":"column-230","name":"PAYEE_NAME","name_without_path":"PAYEE_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-229","object_id":"column-229","name":"PAYEE_TYPE","name_without_path":"PAYEE_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-228","object_id":"column-228","name":"ACCOUNT_NUMBER","name_without_path":"ACCOUNT_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-227","object_id":"column-227","name":"ADDRESS","name_without_path":"ADDRESS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-226","object_id":"column-226","name":"CITY","name_without_path":"CITY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-225","object_id":"column-225","name":"STATE","name_without_path":"STATE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-224","object_id":"column-224","name":"ZIP_CODE","name_without_path":"ZIP_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-223","object_id":"column-223","name":"PHONE","name_without_path":"PHONE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-222","object_id":"column-222","name":"IS_ACTIVE","name_without_path":"IS_ACTIVE","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"1","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-221","object_id":"column-221","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_BILL_PAY_PAYEES_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.BILL_PAY_PAYEES","foreign_table_show_schema":"DIGITAL.BILL_PAY_PAYEES","foreign_table_verbose":"DIGITAL.BILL_PAY_PAYEES","foreign_table_verbose_show_schema":"DIGITAL.BILL_PAY_PAYEES","foreign_table_object_id":"t15","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_BILL_PAY_PAYEES","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"PAYEE_ID","name":"PAYEE_ID","column_id":232}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"DIGITAL.BILL_PAY_PAYEES","object_name_show_schema":"DIGITAL.BILL_PAY_PAYEES","object_type":"TABLE","object_id":"t15","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[]},"object_id":"t15","name":"DIGITAL.BILL_PAY_PAYEES","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"DIGITAL"},{"field":"Name","value":"BILL_PAY_PAYEES"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t19": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-143","object_id":"column-143","name":"SCREENING_ID","name_without_path":"SCREENING_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-142","object_id":"column-142","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-141","object_id":"column-141","name":"TRANSACTION_ID","name_without_path":"TRANSACTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-140","object_id":"column-140","name":"ENTITY_NAME","name_without_path":"ENTITY_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-139","object_id":"column-139","name":"SCREENING_TYPE","name_without_path":"SCREENING_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-138","object_id":"column-138","name":"MATCH_TYPE","name_without_path":"MATCH_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-137","object_id":"column-137","name":"MATCH_SCORE","name_without_path":"MATCH_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-136","object_id":"column-136","name":"LIST_NAME","name_without_path":"LIST_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-135","object_id":"column-135","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Pending'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-134","object_id":"column-134","name":"REVIEW_NOTES","name_without_path":"REVIEW_NOTES","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"1000","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-133","object_id":"column-133","name":"SCREENING_DATE","name_without_path":"SCREENING_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-132","object_id":"column-132","name":"REVIEWED_BY","name_without_path":"REVIEWED_BY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-131","object_id":"column-131","name":"REVIEWED_DATE","name_without_path":"REVIEWED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_SANCTIONS_SCREENING_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_verbose":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_verbose_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_object_id":"t19","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_SANCTIONS_SCREENING","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"SCREENING_ID","name":"SCREENING_ID","column_id":143}],"custom_fields":{}}],"triggers":[{"name":"TR_SANCTIONS_SCREENING_CHANGE","description":null,"action":"After Insert Update ","script":"-- Medium-priority trigger for COMPLIANCE.SANCTIONS_SCREENING\r\nCREATE   TRIGGER TR_SANCTIONS_SCREENING_CHANGE\r\nON COMPLIANCE.SANCTIONS_SCREENING\r\nAFTER INSERT, UPDATE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @op_type NVARCHAR(10) = CASE \r\n        WHEN EXISTS(SELECT * FROM deleted) THEN 'UPDATE' \r\n        ELSE 'INSERT' \r\n    END;\r\n    \r\n    IF @op_type = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'COMPLIANCE', 'SANCTIONS_SCREENING', 'INSERT',\r\n            CAST(SCREENING_ID AS NVARCHAR(100)),\r\n            CAST(SCREENING_DATE AS DATE),\r\n            CASE \r\n                WHEN STATUS = 'Match' OR MATCH_SCORE >= 90 THEN 'HIGH'\r\n                ELSE 'MEDIUM'\r\n            END,\r\n            (SELECT \r\n                outer_ins.SCREENING_ID,\r\n                outer_ins.CUSTOMER_ID,\r\n                outer_ins.ENTITY_NAME,\r\n                outer_ins.SCREENING_TYPE,\r\n                outer_ins.MATCH_TYPE,\r\n                outer_ins.MATCH_SCORE,\r\n                outer_ins.LIST_NAME,\r\n                outer_ins.STATUS,\r\n                outer_ins.SCREENING_DATE\r\n             FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n        FROM inserted outer_ins;\r\n    END\r\n    ELSE\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'COMPLIANCE', 'SANCTIONS_SCREENING', 'UPDATE',\r\n            CAST(i.SCREENING_ID AS NVARCHAR(100)),\r\n            CAST(i.SCREENING_DATE AS DATE),\r\n            CASE \r\n                WHEN i.STATUS = 'Match' OR i.MATCH_SCORE >= 90 THEN 'HIGH'\r\n                ELSE 'MEDIUM'\r\n            END,\r\n            CONCAT(\r\n                '{\"operation\":\"UPDATE\",\"old_values\":',\r\n                (SELECT \r\n                    d.SCREENING_ID,\r\n                    d.STATUS,\r\n                    d.MATCH_SCORE,\r\n                    d.REVIEW_NOTES\r\n                 FROM deleted d \r\n                 WHERE d.SCREENING_ID = i.SCREENING_ID \r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                ',\"new_values\":',\r\n                (SELECT \r\n                    i.SCREENING_ID,\r\n                    i.STATUS,\r\n                    i.MATCH_SCORE,\r\n                    i.REVIEW_NOTES\r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                '}'\r\n            )\r\n        FROM inserted i;\r\n    END\r\nEND;","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"COMPLIANCE.SANCTIONS_SCREENING","object_name_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","object_type":"TABLE","object_id":"t19","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"COMPLIANCE.TR_SANCTIONS_SCREENING_CHANGE","object_name_show_schema":"COMPLIANCE.TR_SANCTIONS_SCREENING_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[]},"object_id":"t19","name":"COMPLIANCE.SANCTIONS_SCREENING","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"COMPLIANCE"},{"field":"Name","value":"SANCTIONS_SCREENING"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t8": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-215","object_id":"column-215","name":"RULE_ID","name_without_path":"RULE_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-214","object_id":"column-214","name":"RULE_NAME","name_without_path":"RULE_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-213","object_id":"column-213","name":"RULE_TYPE","name_without_path":"RULE_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-212","object_id":"column-212","name":"RULE_DESCRIPTION","name_without_path":"RULE_DESCRIPTION","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-211","object_id":"column-211","name":"RISK_SCORE","name_without_path":"RISK_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-210","object_id":"column-210","name":"SEVERITY","name_without_path":"SEVERITY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-209","object_id":"column-209","name":"IS_ACTIVE","name_without_path":"IS_ACTIVE","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"1","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-208","object_id":"column-208","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_RISK_EVENTS_RULE","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"RISK.RISK_RULES","primary_table_show_schema":"RISK.RISK_RULES","primary_table_verbose":"RISK.RISK_RULES","primary_table_verbose_show_schema":"RISK.RISK_RULES","primary_table_object_id":"t8","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"RULE_ID","foreign_column_path":null,"foreign_column":"RULE_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_RISK_RULES","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"RULE_ID","name":"RULE_ID","column_id":215}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[{"object_name":"RISK.RISK_RULES","object_name_show_schema":"RISK.RISK_RULES","object_type":"TABLE","object_id":"t8","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"RISK.RISK_EVENTS","object_name_show_schema":"RISK.RISK_EVENTS","object_type":"TABLE","object_id":"t14","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t8","name":"RISK.RISK_RULES","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"RISK"},{"field":"Name","value":"RISK_RULES"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"d1": {"object_id":"d1","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","description":null,"summary":[{"field":"Host","value":"db-server-ff-demo.database.windows.net"},{"field":"Database","value":"db_azure_ff_demo"},{"field":"DBMS","value":"Azure SQL Database"}],"dbObjects":[{"count":21,"id":"d1t","name":"Tables"},{"count":24,"id":"d1f","name":"Functions"}],"show_schema":true},"t12": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-63","object_id":"column-63","name":"CARD_ACCOUNT_ID","name_without_path":"CARD_ACCOUNT_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-62","object_id":"column-62","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-61","object_id":"column-61","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-60","object_id":"column-60","name":"PROGRAM_ID","name_without_path":"PROGRAM_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t5","name":"CARDS.CARD_PROGRAMS","name_show_schema":"CARDS.CARD_PROGRAMS"}],"linked_lookup":null},{"id":"column-59","object_id":"column-59","name":"LINKED_ACCOUNT_ID","name_without_path":"LINKED_ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t18","name":"CORE.ACCOUNTS","name_show_schema":"CORE.ACCOUNTS"}],"linked_lookup":null},{"id":"column-58","object_id":"column-58","name":"CARD_NUMBER_ENCRYPTED","name_without_path":"CARD_NUMBER_ENCRYPTED","description":null,"is_pk":false,"is_identity":false,"data_type":"varbinary","data_length":"256","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-57","object_id":"column-57","name":"CARD_NUMBER_MASKED","name_without_path":"CARD_NUMBER_MASKED","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-56","object_id":"column-56","name":"EXPIRATION_DATE","name_without_path":"EXPIRATION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"5","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-55","object_id":"column-55","name":"CVV_ENCRYPTED","name_without_path":"CVV_ENCRYPTED","description":null,"is_pk":false,"is_identity":false,"data_type":"varbinary","data_length":"256","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-54","object_id":"column-54","name":"CARD_HOLDER_NAME","name_without_path":"CARD_HOLDER_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-53","object_id":"column-53","name":"CREDIT_LIMIT","name_without_path":"CREDIT_LIMIT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-52","object_id":"column-52","name":"AVAILABLE_CREDIT","name_without_path":"AVAILABLE_CREDIT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-51","object_id":"column-51","name":"CURRENT_BALANCE","name_without_path":"CURRENT_BALANCE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-50","object_id":"column-50","name":"MINIMUM_PAYMENT","name_without_path":"MINIMUM_PAYMENT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"10, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-49","object_id":"column-49","name":"LAST_PAYMENT_DATE","name_without_path":"LAST_PAYMENT_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-48","object_id":"column-48","name":"NEXT_PAYMENT_DUE","name_without_path":"NEXT_PAYMENT_DUE","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-47","object_id":"column-47","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-46","object_id":"column-46","name":"ISSUE_DATE","name_without_path":"ISSUE_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-45","object_id":"column-45","name":"ACTIVATION_DATE","name_without_path":"ACTIVATION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-44","object_id":"column-44","name":"BLOCK_REASON","name_without_path":"BLOCK_REASON","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-43","object_id":"column-43","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_CARD_ACCOUNTS_LINKED_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"LINKED_ACCOUNT_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_PROGRAM","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CARDS.CARD_PROGRAMS","primary_table_show_schema":"CARDS.CARD_PROGRAMS","primary_table_verbose":"CARDS.CARD_PROGRAMS","primary_table_verbose_show_schema":"CARDS.CARD_PROGRAMS","primary_table_object_id":"t5","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"PROGRAM_ID","foreign_column_path":null,"foreign_column":"PROGRAM_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_CARD_TRANSACTIONS_CARD_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_TRANSACTIONS","foreign_table_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_object_id":"t10","primary_table":"CARDS.CARD_ACCOUNTS","primary_table_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_verbose":"CARDS.CARD_ACCOUNTS","primary_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_object_id":"t12","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CARD_ACCOUNT_ID","foreign_column_path":null,"foreign_column":"CARD_ACCOUNT_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_CARD_ACCOUNTS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"CARD_ACCOUNT_ID","name":"CARD_ACCOUNT_ID","column_id":63}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_PROGRAMS","object_name_show_schema":"CARDS.CARD_PROGRAMS","object_type":"TABLE","object_id":"t5","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_TRANSACTIONS","object_name_show_schema":"CARDS.CARD_TRANSACTIONS","object_type":"TABLE","object_id":"t10","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t12","name":"CARDS.CARD_ACCOUNTS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CARDS"},{"field":"Name","value":"CARD_ACCOUNTS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f7": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f7","name":"cdc.fn_cdc_get_net_changes_CARDS_CARD_ACCOUNTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CARDS_CARD_ACCOUNTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CARDS_CARD_ACCOUNTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CARD_ACCOUNT_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [PROGRAM_ID], NULL as [LINKED_ACCOUNT_ID], NULL as [CARD_NUMBER_ENCRYPTED], NULL as [CARD_NUMBER_MASKED], NULL as [EXPIRATION_DATE], NULL as [CVV_ENCRYPTED], NULL as [CARD_HOLDER_NAME], NULL as [CREDIT_LIMIT], NULL as [AVAILABLE_CREDIT], NULL as [CURRENT_BALANCE], NULL as [MINIMUM_PAYMENT], NULL as [LAST_PAYMENT_DATE], NULL as [NEXT_PAYMENT_DUE], NULL as [STATUS], NULL as [ISSUE_DATE], NULL as [ACTIVATION_DATE], NULL as [BLOCK_REASON], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_C4BFDE9E\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_C4BFDE9E \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [CARD_ACCOUNT_ID], [INSTITUTION_ID], [CUSTOMER_ID], [PROGRAM_ID], [LINKED_ACCOUNT_ID], [CARD_NUMBER_ENCRYPTED], [CARD_NUMBER_MASKED], [EXPIRATION_DATE], [CVV_ENCRYPTED], [CARD_HOLDER_NAME], [CREDIT_LIMIT], [AVAILABLE_CREDIT], [CURRENT_BALANCE], [MINIMUM_PAYMENT], [LAST_PAYMENT_DATE], [NEXT_PAYMENT_DUE], [STATUS], [ISSUE_DATE], [ACTIVATION_DATE], [BLOCK_REASON], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_C4BFDE9E \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_C4BFDE9E, __$count_C4BFDE9E, t.[CARD_ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PROGRAM_ID], t.[LINKED_ACCOUNT_ID], t.[CARD_NUMBER_ENCRYPTED], t.[CARD_NUMBER_MASKED], t.[EXPIRATION_DATE], t.[CVV_ENCRYPTED], t.[CARD_HOLDER_NAME], t.[CREDIT_LIMIT], t.[AVAILABLE_CREDIT], t.[CURRENT_BALANCE], t.[MINIMUM_PAYMENT], t.[LAST_PAYMENT_DATE], t.[NEXT_PAYMENT_DUE], t.[STATUS], t.[ISSUE_DATE], t.[ACTIVATION_DATE], t.[BLOCK_REASON], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CARD_ACCOUNT_ID],\r\n\t\t    count(*) as __$count_C4BFDE9E \r\n\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CARD_ACCOUNT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock) where  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CARD_ACCOUNT_ID] = m.[CARD_ACCOUNT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_ACCOUNT_ID] = mo.[CARD_ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_C4BFDE9E\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_C4BFDE9E \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_C4BFDE9E\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_C4BFDE9E \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [CARD_ACCOUNT_ID], [INSTITUTION_ID], [CUSTOMER_ID], [PROGRAM_ID], [LINKED_ACCOUNT_ID], [CARD_NUMBER_ENCRYPTED], [CARD_NUMBER_MASKED], [EXPIRATION_DATE], [CVV_ENCRYPTED], [CARD_HOLDER_NAME], [CREDIT_LIMIT], [AVAILABLE_CREDIT], [CURRENT_BALANCE], [MINIMUM_PAYMENT], [LAST_PAYMENT_DATE], [NEXT_PAYMENT_DUE], [STATUS], [ISSUE_DATE], [ACTIVATION_DATE], [BLOCK_REASON], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_C4BFDE9E \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_C4BFDE9E, __$count_C4BFDE9E, \r\n\t\tm.__$update_mask , t.[CARD_ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PROGRAM_ID], t.[LINKED_ACCOUNT_ID], t.[CARD_NUMBER_ENCRYPTED], t.[CARD_NUMBER_MASKED], t.[EXPIRATION_DATE], t.[CVV_ENCRYPTED], t.[CARD_HOLDER_NAME], t.[CREDIT_LIMIT], t.[AVAILABLE_CREDIT], t.[CURRENT_BALANCE], t.[MINIMUM_PAYMENT], t.[LAST_PAYMENT_DATE], t.[NEXT_PAYMENT_DUE], t.[STATUS], t.[ISSUE_DATE], t.[ACTIVATION_DATE], t.[BLOCK_REASON], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CARD_ACCOUNT_ID],\r\n\t\t    count(*) as __$count_C4BFDE9E, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CARD_ACCOUNT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock) where  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CARD_ACCOUNT_ID] = m.[CARD_ACCOUNT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_ACCOUNT_ID] = mo.[CARD_ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[CARD_ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PROGRAM_ID], t.[LINKED_ACCOUNT_ID], t.[CARD_NUMBER_ENCRYPTED], t.[CARD_NUMBER_MASKED], t.[EXPIRATION_DATE], t.[CVV_ENCRYPTED], t.[CARD_HOLDER_NAME], t.[CREDIT_LIMIT], t.[AVAILABLE_CREDIT], t.[CURRENT_BALANCE], t.[MINIMUM_PAYMENT], t.[LAST_PAYMENT_DATE], t.[NEXT_PAYMENT_DUE], t.[STATUS], t.[ISSUE_DATE], t.[ACTIVATION_DATE], t.[BLOCK_REASON], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock) where  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_ACCOUNT_ID] = t.[CARD_ACCOUNT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_ACCOUNTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_ACCOUNT_ID] = mo.[CARD_ACCOUNT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f19": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f19","name":"cdc.fn_cdc_get_net_changes_CORE_CUSTOMERS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CORE_CUSTOMERS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CORE_CUSTOMERS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CUSTOMER_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_NUMBER], NULL as [CUSTOMER_TYPE], NULL as [FIRST_NAME], NULL as [LAST_NAME], NULL as [BUSINESS_NAME], NULL as [DATE_OF_BIRTH], NULL as [SSN_ENCRYPTED], NULL as [EIN_ENCRYPTED], NULL as [EMAIL], NULL as [PHONE], NULL as [ADDRESS], NULL as [CITY], NULL as [STATE], NULL as [ZIP_CODE], NULL as [CREDIT_SCORE], NULL as [RISK_RATING], NULL as [KYC_STATUS], NULL as [CUSTOMER_SINCE], NULL as [LAST_LOGIN_DATE], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BC4B22C0\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BC4B22C0 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [CUSTOMER_ID], [INSTITUTION_ID], [CUSTOMER_NUMBER], [CUSTOMER_TYPE], [FIRST_NAME], [LAST_NAME], [BUSINESS_NAME], [DATE_OF_BIRTH], [SSN_ENCRYPTED], [EIN_ENCRYPTED], [EMAIL], [PHONE], [ADDRESS], [CITY], [STATE], [ZIP_CODE], [CREDIT_SCORE], [RISK_RATING], [KYC_STATUS], [CUSTOMER_SINCE], [LAST_LOGIN_DATE], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BC4B22C0 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BC4B22C0, __$count_BC4B22C0, t.[CUSTOMER_ID], t.[INSTITUTION_ID], t.[CUSTOMER_NUMBER], t.[CUSTOMER_TYPE], t.[FIRST_NAME], t.[LAST_NAME], t.[BUSINESS_NAME], t.[DATE_OF_BIRTH], t.[SSN_ENCRYPTED], t.[EIN_ENCRYPTED], t.[EMAIL], t.[PHONE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[CREDIT_SCORE], t.[RISK_RATING], t.[KYC_STATUS], t.[CUSTOMER_SINCE], t.[LAST_LOGIN_DATE], t.[STATUS], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[CORE_CUSTOMERS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CUSTOMER_ID],\r\n\t\t    count(*) as __$count_BC4B22C0 \r\n\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CUSTOMER_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_CUSTOMERS_CT] c with (nolock) where  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CUSTOMER_ID] = m.[CUSTOMER_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_CUSTOMERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CUSTOMER_ID] = mo.[CUSTOMER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BC4B22C0\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BC4B22C0 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_BC4B22C0\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_BC4B22C0 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [CUSTOMER_ID], [INSTITUTION_ID], [CUSTOMER_NUMBER], [CUSTOMER_TYPE], [FIRST_NAME], [LAST_NAME], [BUSINESS_NAME], [DATE_OF_BIRTH], [SSN_ENCRYPTED], [EIN_ENCRYPTED], [EMAIL], [PHONE], [ADDRESS], [CITY], [STATE], [ZIP_CODE], [CREDIT_SCORE], [RISK_RATING], [KYC_STATUS], [CUSTOMER_SINCE], [LAST_LOGIN_DATE], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BC4B22C0 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BC4B22C0, __$count_BC4B22C0, \r\n\t\tm.__$update_mask , t.[CUSTOMER_ID], t.[INSTITUTION_ID], t.[CUSTOMER_NUMBER], t.[CUSTOMER_TYPE], t.[FIRST_NAME], t.[LAST_NAME], t.[BUSINESS_NAME], t.[DATE_OF_BIRTH], t.[SSN_ENCRYPTED], t.[EIN_ENCRYPTED], t.[EMAIL], t.[PHONE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[CREDIT_SCORE], t.[RISK_RATING], t.[KYC_STATUS], t.[CUSTOMER_SINCE], t.[LAST_LOGIN_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_CUSTOMERS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CUSTOMER_ID],\r\n\t\t    count(*) as __$count_BC4B22C0, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CUSTOMER_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_CUSTOMERS_CT] c with (nolock) where  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CUSTOMER_ID] = m.[CUSTOMER_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_CUSTOMERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CUSTOMER_ID] = mo.[CUSTOMER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[CUSTOMER_ID], t.[INSTITUTION_ID], t.[CUSTOMER_NUMBER], t.[CUSTOMER_TYPE], t.[FIRST_NAME], t.[LAST_NAME], t.[BUSINESS_NAME], t.[DATE_OF_BIRTH], t.[SSN_ENCRYPTED], t.[EIN_ENCRYPTED], t.[EMAIL], t.[PHONE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[CREDIT_SCORE], t.[RISK_RATING], t.[KYC_STATUS], t.[CUSTOMER_SINCE], t.[LAST_LOGIN_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_CUSTOMERS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_CUSTOMERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_CUSTOMERS_CT] c with (nolock) where  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_CUSTOMERS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CUSTOMER_ID] = t.[CUSTOMER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_CUSTOMERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CUSTOMER_ID] = mo.[CUSTOMER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f20": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f20","name":"cdc.fn_cdc_get_all_changes_CORE_PRODUCT_TYPES","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CORE_PRODUCT_TYPES"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CORE_PRODUCT_TYPES]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [PRODUCT_TYPE_ID], NULL as [PRODUCT_CODE], NULL as [PRODUCT_NAME], NULL as [PRODUCT_CATEGORY], NULL as [INTEREST_RATE], NULL as [MINIMUM_BALANCE], NULL as [MONTHLY_FEE], NULL as [OVERDRAFT_FEE], NULL as [IS_ACTIVE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[PRODUCT_TYPE_ID], t.[PRODUCT_CODE], t.[PRODUCT_NAME], t.[PRODUCT_CATEGORY], t.[INTEREST_RATE], t.[MINIMUM_BALANCE], t.[MONTHLY_FEE], t.[OVERDRAFT_FEE], t.[IS_ACTIVE]\r\n\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[PRODUCT_TYPE_ID], t.[PRODUCT_CODE], t.[PRODUCT_NAME], t.[PRODUCT_CATEGORY], t.[INTEREST_RATE], t.[MINIMUM_BALANCE], t.[MONTHLY_FEE], t.[OVERDRAFT_FEE], t.[IS_ACTIVE]\r\n\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t16": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-246","object_id":"column-246","name":"USER_ID","name_without_path":"USER_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-245","object_id":"column-245","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-244","object_id":"column-244","name":"USERNAME","name_without_path":"USERNAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-243","object_id":"column-243","name":"PASSWORD_HASH","name_without_path":"PASSWORD_HASH","description":null,"is_pk":false,"is_identity":false,"data_type":"varbinary","data_length":"256","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-242","object_id":"column-242","name":"EMAIL","name_without_path":"EMAIL","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"250","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-241","object_id":"column-241","name":"MOBILE_PHONE","name_without_path":"MOBILE_PHONE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-240","object_id":"column-240","name":"LAST_LOGIN_DATE","name_without_path":"LAST_LOGIN_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-239","object_id":"column-239","name":"LOGIN_ATTEMPTS","name_without_path":"LOGIN_ATTEMPTS","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-238","object_id":"column-238","name":"IS_LOCKED","name_without_path":"IS_LOCKED","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-237","object_id":"column-237","name":"LOCKOUT_END_DATE","name_without_path":"LOCKOUT_END_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-236","object_id":"column-236","name":"TWO_FACTOR_ENABLED","name_without_path":"TWO_FACTOR_ENABLED","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-235","object_id":"column-235","name":"PREFERRED_NOTIFICATION_METHOD","name_without_path":"PREFERRED_NOTIFICATION_METHOD","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Email'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-234","object_id":"column-234","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-233","object_id":"column-233","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_DIGITAL_USERS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.DIGITAL_USERS","foreign_table_show_schema":"DIGITAL.DIGITAL_USERS","foreign_table_verbose":"DIGITAL.DIGITAL_USERS","foreign_table_verbose_show_schema":"DIGITAL.DIGITAL_USERS","foreign_table_object_id":"t16","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_USER_SESSIONS_USER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.USER_SESSIONS","foreign_table_show_schema":"DIGITAL.USER_SESSIONS","foreign_table_verbose":"DIGITAL.USER_SESSIONS","foreign_table_verbose_show_schema":"DIGITAL.USER_SESSIONS","foreign_table_object_id":"t3","primary_table":"DIGITAL.DIGITAL_USERS","primary_table_show_schema":"DIGITAL.DIGITAL_USERS","primary_table_verbose":"DIGITAL.DIGITAL_USERS","primary_table_verbose_show_schema":"DIGITAL.DIGITAL_USERS","primary_table_object_id":"t16","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"USER_ID","foreign_column_path":null,"foreign_column":"USER_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_DIGITAL_USERS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"USER_ID","name":"USER_ID","column_id":246}],"custom_fields":{}},{"name":"UQ_DIGITAL_USERS_EMAIL","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"EMAIL","name":"EMAIL","column_id":242}],"custom_fields":{}},{"name":"UQ_DIGITAL_USERS_USERNAME","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"USERNAME","name":"USERNAME","column_id":244}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"DIGITAL.DIGITAL_USERS","object_name_show_schema":"DIGITAL.DIGITAL_USERS","object_type":"TABLE","object_id":"t16","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[{"object_name":"DIGITAL.DIGITAL_USERS","object_name_show_schema":"DIGITAL.DIGITAL_USERS","object_type":"TABLE","object_id":"t16","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"DIGITAL.USER_SESSIONS","object_name_show_schema":"DIGITAL.USER_SESSIONS","object_type":"TABLE","object_id":"t3","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t16","name":"DIGITAL.DIGITAL_USERS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"DIGITAL"},{"field":"Name","value":"DIGITAL_USERS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t18": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-87","object_id":"column-87","name":"ACCOUNT_ID","name_without_path":"ACCOUNT_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-86","object_id":"column-86","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-85","object_id":"column-85","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t11","name":"CORE.CUSTOMERS","name_show_schema":"CORE.CUSTOMERS"}],"linked_lookup":null},{"id":"column-84","object_id":"column-84","name":"PRODUCT_TYPE_ID","name_without_path":"PRODUCT_TYPE_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t9","name":"CORE.PRODUCT_TYPES","name_show_schema":"CORE.PRODUCT_TYPES"}],"linked_lookup":null},{"id":"column-83","object_id":"column-83","name":"ACCOUNT_NUMBER","name_without_path":"ACCOUNT_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-82","object_id":"column-82","name":"ACCOUNT_NAME","name_without_path":"ACCOUNT_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-81","object_id":"column-81","name":"CURRENT_BALANCE","name_without_path":"CURRENT_BALANCE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"15, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-80","object_id":"column-80","name":"AVAILABLE_BALANCE","name_without_path":"AVAILABLE_BALANCE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"15, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-79","object_id":"column-79","name":"PENDING_BALANCE","name_without_path":"PENDING_BALANCE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"15, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-78","object_id":"column-78","name":"OVERDRAFT_LIMIT","name_without_path":"OVERDRAFT_LIMIT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-77","object_id":"column-77","name":"INTEREST_RATE","name_without_path":"INTEREST_RATE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-76","object_id":"column-76","name":"OPEN_DATE","name_without_path":"OPEN_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-75","object_id":"column-75","name":"LAST_TRANSACTION_DATE","name_without_path":"LAST_TRANSACTION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-74","object_id":"column-74","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-73","object_id":"column-73","name":"CLOSE_DATE","name_without_path":"CLOSE_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-181","object_id":"column-181","name":"CLOSE_REASON","name_without_path":"CLOSE_REASON","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-180","object_id":"column-180","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_ACCOUNTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_ACCOUNTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_ACCOUNTS_PRODUCT_TYPE","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.PRODUCT_TYPES","primary_table_show_schema":"CORE.PRODUCT_TYPES","primary_table_verbose":"CORE.PRODUCT_TYPES","primary_table_verbose_show_schema":"CORE.PRODUCT_TYPES","primary_table_object_id":"t9","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"PRODUCT_TYPE_ID","foreign_column_path":null,"foreign_column":"PRODUCT_TYPE_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_LINKED_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"LINKED_ACCOUNT_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_DEBIT_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"DEBIT_ACCOUNT_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_CREDIT_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"CREDIT_ACCOUNT_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_ACCOUNTS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"ACCOUNT_ID","name":"ACCOUNT_ID","column_id":87}],"custom_fields":{}},{"name":"UQ_ACCOUNTS_NUMBER","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_ID","name":"INSTITUTION_ID","column_id":86},{"path":null,"name_without_path":"ACCOUNT_NUMBER","name":"ACCOUNT_NUMBER","column_id":83}],"custom_fields":{}}],"triggers":[{"name":"TR_ACCOUNTS_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_ACCOUNTS_EventLog\r\nON CORE.ACCOUNTS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'ACCOUNTS',\r\n            'INSERT',\r\n            CAST(ACCOUNT_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.ACCOUNT_ID = inserted.ACCOUNT_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'ACCOUNTS',\r\n            'UPDATE',\r\n            CAST(i.ACCOUNT_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.ACCOUNT_ID = i.ACCOUNT_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.ACCOUNT_ID = i.ACCOUNT_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'CORE',\r\n            'ACCOUNTS',\r\n            'DELETE',\r\n            CAST(ACCOUNT_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.ACCOUNT_ID = deleted.ACCOUNT_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.PRODUCT_TYPES","object_name_show_schema":"CORE.PRODUCT_TYPES","object_type":"TABLE","object_id":"t9","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"CORE.TR_ACCOUNTS_EventLog","object_name_show_schema":"CORE.TR_ACCOUNTS_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"PAYMENTS.TRANSACTIONS","object_name_show_schema":"PAYMENTS.TRANSACTIONS","object_type":"TABLE","object_id":"t6","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"PAYMENTS.TRANSACTIONS","object_name_show_schema":"PAYMENTS.TRANSACTIONS","object_type":"TABLE","object_id":"t6","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t18","name":"CORE.ACCOUNTS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CORE"},{"field":"Name","value":"ACCOUNTS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f2": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f2","name":"cdc.fn_cdc_get_all_changes_CARDS_CARD_ACCOUNTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CARDS_CARD_ACCOUNTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CARDS_CARD_ACCOUNTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CARD_ACCOUNT_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [PROGRAM_ID], NULL as [LINKED_ACCOUNT_ID], NULL as [CARD_NUMBER_ENCRYPTED], NULL as [CARD_NUMBER_MASKED], NULL as [EXPIRATION_DATE], NULL as [CVV_ENCRYPTED], NULL as [CARD_HOLDER_NAME], NULL as [CREDIT_LIMIT], NULL as [AVAILABLE_CREDIT], NULL as [CURRENT_BALANCE], NULL as [MINIMUM_PAYMENT], NULL as [LAST_PAYMENT_DATE], NULL as [NEXT_PAYMENT_DUE], NULL as [STATUS], NULL as [ISSUE_DATE], NULL as [ACTIVATION_DATE], NULL as [BLOCK_REASON], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CARD_ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PROGRAM_ID], t.[LINKED_ACCOUNT_ID], t.[CARD_NUMBER_ENCRYPTED], t.[CARD_NUMBER_MASKED], t.[EXPIRATION_DATE], t.[CVV_ENCRYPTED], t.[CARD_HOLDER_NAME], t.[CREDIT_LIMIT], t.[AVAILABLE_CREDIT], t.[CURRENT_BALANCE], t.[MINIMUM_PAYMENT], t.[LAST_PAYMENT_DATE], t.[NEXT_PAYMENT_DUE], t.[STATUS], t.[ISSUE_DATE], t.[ACTIVATION_DATE], t.[BLOCK_REASON], t.[CREATED_DATE]\r\n\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CARD_ACCOUNT_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[PROGRAM_ID], t.[LINKED_ACCOUNT_ID], t.[CARD_NUMBER_ENCRYPTED], t.[CARD_NUMBER_MASKED], t.[EXPIRATION_DATE], t.[CVV_ENCRYPTED], t.[CARD_HOLDER_NAME], t.[CREDIT_LIMIT], t.[AVAILABLE_CREDIT], t.[CURRENT_BALANCE], t.[MINIMUM_PAYMENT], t.[LAST_PAYMENT_DATE], t.[NEXT_PAYMENT_DUE], t.[STATUS], t.[ISSUE_DATE], t.[ACTIVATION_DATE], t.[BLOCK_REASON], t.[CREATED_DATE]\r\n\tfrom [cdc].[CARDS_CARD_ACCOUNTS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_ACCOUNTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"d1t": {"tables":[{"id":"t2","name":"ADF_CONTROL.CHANGE_LOG","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t4","name":"ADF_CONTROL.TABLE_WATERMARKS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t13","name":"ANALYTICS.DAILY_METRICS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t12","name":"CARDS.CARD_ACCOUNTS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t5","name":"CARDS.CARD_PROGRAMS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t10","name":"CARDS.CARD_TRANSACTIONS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t20","name":"cdc.EventLog","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t1","name":"COMPLIANCE.REGULATORY_REPORTS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t19","name":"COMPLIANCE.SANCTIONS_SCREENING","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t18","name":"CORE.ACCOUNTS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t11","name":"CORE.CUSTOMERS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t9","name":"CORE.PRODUCT_TYPES","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t17","name":"dbo.EventLog","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t15","name":"DIGITAL.BILL_PAY_PAYEES","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t16","name":"DIGITAL.DIGITAL_USERS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t3","name":"DIGITAL.USER_SESSIONS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t21","name":"PAYMENTS.PAYMENT_NETWORKS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t6","name":"PAYMENTS.TRANSACTIONS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t14","name":"RISK.RISK_EVENTS","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"t8","name":"RISK.RISK_RULES","type":"TABLE","subtype":"TABLE","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}}],"object_id":"d1t","title_prefix":null,"custom_fields":[]},"t5": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-184","object_id":"column-184","name":"PROGRAM_ID","name_without_path":"PROGRAM_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-183","object_id":"column-183","name":"PROGRAM_CODE","name_without_path":"PROGRAM_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-182","object_id":"column-182","name":"PROGRAM_NAME","name_without_path":"PROGRAM_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-72","object_id":"column-72","name":"CARD_TYPE","name_without_path":"CARD_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-71","object_id":"column-71","name":"CARD_NETWORK","name_without_path":"CARD_NETWORK","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-70","object_id":"column-70","name":"BIN","name_without_path":"BIN","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"6","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-69","object_id":"column-69","name":"ANNUAL_FEE","name_without_path":"ANNUAL_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-68","object_id":"column-68","name":"INTEREST_RATE","name_without_path":"INTEREST_RATE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"6, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-67","object_id":"column-67","name":"CASH_ADVANCE_FEE","name_without_path":"CASH_ADVANCE_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-66","object_id":"column-66","name":"FOREIGN_TRANSACTION_FEE","name_without_path":"FOREIGN_TRANSACTION_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-65","object_id":"column-65","name":"REWARDS_PROGRAM","name_without_path":"REWARDS_PROGRAM","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-64","object_id":"column-64","name":"IS_ACTIVE","name_without_path":"IS_ACTIVE","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"1","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_CARD_ACCOUNTS_PROGRAM","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CARDS.CARD_PROGRAMS","primary_table_show_schema":"CARDS.CARD_PROGRAMS","primary_table_verbose":"CARDS.CARD_PROGRAMS","primary_table_verbose_show_schema":"CARDS.CARD_PROGRAMS","primary_table_object_id":"t5","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"PROGRAM_ID","foreign_column_path":null,"foreign_column":"PROGRAM_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_CARD_PROGRAMS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"PROGRAM_ID","name":"PROGRAM_ID","column_id":184}],"custom_fields":{}},{"name":"UQ_CARD_PROGRAMS_CODE","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"PROGRAM_CODE","name":"PROGRAM_CODE","column_id":183}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[{"object_name":"CARDS.CARD_PROGRAMS","object_name_show_schema":"CARDS.CARD_PROGRAMS","object_type":"TABLE","object_id":"t5","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t5","name":"CARDS.CARD_PROGRAMS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CARDS"},{"field":"Name","value":"CARD_PROGRAMS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f23": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f23","name":"cdc.fn_cdc_get_net_changes_CARDS_CARD_TRANSACTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CARDS_CARD_TRANSACTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CARDS_CARD_TRANSACTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CARD_TRANSACTION_ID], NULL as [CARD_ACCOUNT_ID], NULL as [TRANSACTION_TYPE], NULL as [AMOUNT], NULL as [CURRENCY], NULL as [MERCHANT_NAME], NULL as [MERCHANT_CATEGORY], NULL as [MERCHANT_ID], NULL as [TRANSACTION_DATE], NULL as [POSTING_DATE], NULL as [AUTHORIZATION_CODE], NULL as [NETWORK_TRANSACTION_ID], NULL as [STATUS], NULL as [DECLINE_REASON], NULL as [LOCATION], NULL as [COUNTRY], NULL as [RISK_SCORE], NULL as [FRAUD_FLAG], NULL as [REWARDS_EARNED], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_F76CC387\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_F76CC387 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [CARD_TRANSACTION_ID], [CARD_ACCOUNT_ID], [TRANSACTION_TYPE], [AMOUNT], [CURRENCY], [MERCHANT_NAME], [MERCHANT_CATEGORY], [MERCHANT_ID], [TRANSACTION_DATE], [POSTING_DATE], [AUTHORIZATION_CODE], [NETWORK_TRANSACTION_ID], [STATUS], [DECLINE_REASON], [LOCATION], [COUNTRY], [RISK_SCORE], [FRAUD_FLAG], [REWARDS_EARNED], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_F76CC387 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_F76CC387, __$count_F76CC387, t.[CARD_TRANSACTION_ID], t.[CARD_ACCOUNT_ID], t.[TRANSACTION_TYPE], t.[AMOUNT], t.[CURRENCY], t.[MERCHANT_NAME], t.[MERCHANT_CATEGORY], t.[MERCHANT_ID], t.[TRANSACTION_DATE], t.[POSTING_DATE], t.[AUTHORIZATION_CODE], t.[NETWORK_TRANSACTION_ID], t.[STATUS], t.[DECLINE_REASON], t.[LOCATION], t.[COUNTRY], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[REWARDS_EARNED], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CARD_TRANSACTION_ID],\r\n\t\t    count(*) as __$count_F76CC387 \r\n\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CARD_TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock) where  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CARD_TRANSACTION_ID] = m.[CARD_TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_TRANSACTION_ID] = mo.[CARD_TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_F76CC387\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_F76CC387 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_F76CC387\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_F76CC387 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [CARD_TRANSACTION_ID], [CARD_ACCOUNT_ID], [TRANSACTION_TYPE], [AMOUNT], [CURRENCY], [MERCHANT_NAME], [MERCHANT_CATEGORY], [MERCHANT_ID], [TRANSACTION_DATE], [POSTING_DATE], [AUTHORIZATION_CODE], [NETWORK_TRANSACTION_ID], [STATUS], [DECLINE_REASON], [LOCATION], [COUNTRY], [RISK_SCORE], [FRAUD_FLAG], [REWARDS_EARNED], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_F76CC387 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_F76CC387, __$count_F76CC387, \r\n\t\tm.__$update_mask , t.[CARD_TRANSACTION_ID], t.[CARD_ACCOUNT_ID], t.[TRANSACTION_TYPE], t.[AMOUNT], t.[CURRENCY], t.[MERCHANT_NAME], t.[MERCHANT_CATEGORY], t.[MERCHANT_ID], t.[TRANSACTION_DATE], t.[POSTING_DATE], t.[AUTHORIZATION_CODE], t.[NETWORK_TRANSACTION_ID], t.[STATUS], t.[DECLINE_REASON], t.[LOCATION], t.[COUNTRY], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[REWARDS_EARNED], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[CARD_TRANSACTION_ID],\r\n\t\t    count(*) as __$count_F76CC387, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[CARD_TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock) where  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[CARD_TRANSACTION_ID] = m.[CARD_TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_TRANSACTION_ID] = mo.[CARD_TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[CARD_TRANSACTION_ID], t.[CARD_ACCOUNT_ID], t.[TRANSACTION_TYPE], t.[AMOUNT], t.[CURRENCY], t.[MERCHANT_NAME], t.[MERCHANT_CATEGORY], t.[MERCHANT_ID], t.[TRANSACTION_DATE], t.[POSTING_DATE], t.[AUTHORIZATION_CODE], t.[NETWORK_TRANSACTION_ID], t.[STATUS], t.[DECLINE_REASON], t.[LOCATION], t.[COUNTRY], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[REWARDS_EARNED], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock) where  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[CARD_TRANSACTION_ID] = t.[CARD_TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CARDS_CARD_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[CARD_TRANSACTION_ID] = mo.[CARD_TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f18": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f18","name":"cdc.fn_cdc_get_net_changes_CORE_FINANCIAL_INSTITUTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CORE_FINANCIAL_INSTITUTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CORE_FINANCIAL_INSTITUTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [INSTITUTION_ID], NULL as [INSTITUTION_CODE], NULL as [INSTITUTION_NAME], NULL as [INSTITUTION_TYPE], NULL as [ROUTING_NUMBER], NULL as [SWIFT_CODE], NULL as [ADDRESS], NULL as [CITY], NULL as [STATE], NULL as [ZIP_CODE], NULL as [COUNTRY], NULL as [REGULATION_LEVEL], NULL as [ASSETS_UNDER_MANAGEMENT], NULL as [CUSTOMER_COUNT], NULL as [PLATFORM_ONBOARD_DATE], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_11CEFE40\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_11CEFE40 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [INSTITUTION_ID], [INSTITUTION_CODE], [INSTITUTION_NAME], [INSTITUTION_TYPE], [ROUTING_NUMBER], [SWIFT_CODE], [ADDRESS], [CITY], [STATE], [ZIP_CODE], [COUNTRY], [REGULATION_LEVEL], [ASSETS_UNDER_MANAGEMENT], [CUSTOMER_COUNT], [PLATFORM_ONBOARD_DATE], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_11CEFE40 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_11CEFE40, __$count_11CEFE40, t.[INSTITUTION_ID], t.[INSTITUTION_CODE], t.[INSTITUTION_NAME], t.[INSTITUTION_TYPE], t.[ROUTING_NUMBER], t.[SWIFT_CODE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[COUNTRY], t.[REGULATION_LEVEL], t.[ASSETS_UNDER_MANAGEMENT], t.[CUSTOMER_COUNT], t.[PLATFORM_ONBOARD_DATE], t.[STATUS], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[INSTITUTION_ID],\r\n\t\t    count(*) as __$count_11CEFE40 \r\n\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[INSTITUTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock) where  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[INSTITUTION_ID] = m.[INSTITUTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[INSTITUTION_ID] = mo.[INSTITUTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_11CEFE40\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_11CEFE40 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_11CEFE40\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_11CEFE40 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [INSTITUTION_ID], [INSTITUTION_CODE], [INSTITUTION_NAME], [INSTITUTION_TYPE], [ROUTING_NUMBER], [SWIFT_CODE], [ADDRESS], [CITY], [STATE], [ZIP_CODE], [COUNTRY], [REGULATION_LEVEL], [ASSETS_UNDER_MANAGEMENT], [CUSTOMER_COUNT], [PLATFORM_ONBOARD_DATE], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_11CEFE40 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_11CEFE40, __$count_11CEFE40, \r\n\t\tm.__$update_mask , t.[INSTITUTION_ID], t.[INSTITUTION_CODE], t.[INSTITUTION_NAME], t.[INSTITUTION_TYPE], t.[ROUTING_NUMBER], t.[SWIFT_CODE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[COUNTRY], t.[REGULATION_LEVEL], t.[ASSETS_UNDER_MANAGEMENT], t.[CUSTOMER_COUNT], t.[PLATFORM_ONBOARD_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[INSTITUTION_ID],\r\n\t\t    count(*) as __$count_11CEFE40, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[INSTITUTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock) where  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[INSTITUTION_ID] = m.[INSTITUTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[INSTITUTION_ID] = mo.[INSTITUTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[INSTITUTION_ID], t.[INSTITUTION_CODE], t.[INSTITUTION_NAME], t.[INSTITUTION_TYPE], t.[ROUTING_NUMBER], t.[SWIFT_CODE], t.[ADDRESS], t.[CITY], t.[STATE], t.[ZIP_CODE], t.[COUNTRY], t.[REGULATION_LEVEL], t.[ASSETS_UNDER_MANAGEMENT], t.[CUSTOMER_COUNT], t.[PLATFORM_ONBOARD_DATE], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_FINANCIAL_INSTITUTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock) where  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[INSTITUTION_ID] = t.[INSTITUTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_FINANCIAL_INSTITUTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[INSTITUTION_ID] = mo.[INSTITUTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f21": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f21","name":"cdc.fn_cdc_get_all_changes_DIGITAL_DIGITAL_USERS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_DIGITAL_DIGITAL_USERS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_DIGITAL_DIGITAL_USERS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [USER_ID], NULL as [CUSTOMER_ID], NULL as [USERNAME], NULL as [PASSWORD_HASH], NULL as [EMAIL], NULL as [MOBILE_PHONE], NULL as [LAST_LOGIN_DATE], NULL as [LOGIN_ATTEMPTS], NULL as [IS_LOCKED], NULL as [LOCKOUT_END_DATE], NULL as [TWO_FACTOR_ENABLED], NULL as [PREFERRED_NOTIFICATION_METHOD], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[USER_ID], t.[CUSTOMER_ID], t.[USERNAME], t.[PASSWORD_HASH], t.[EMAIL], t.[MOBILE_PHONE], t.[LAST_LOGIN_DATE], t.[LOGIN_ATTEMPTS], t.[IS_LOCKED], t.[LOCKOUT_END_DATE], t.[TWO_FACTOR_ENABLED], t.[PREFERRED_NOTIFICATION_METHOD], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[USER_ID], t.[CUSTOMER_ID], t.[USERNAME], t.[PASSWORD_HASH], t.[EMAIL], t.[MOBILE_PHONE], t.[LAST_LOGIN_DATE], t.[LOGIN_ATTEMPTS], t.[IS_LOCKED], t.[LOCKOUT_END_DATE], t.[TWO_FACTOR_ENABLED], t.[PREFERRED_NOTIFICATION_METHOD], t.[STATUS], t.[CREATED_DATE]\r\n\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t3": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-268","object_id":"column-268","name":"SESSION_ID","name_without_path":"SESSION_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-267","object_id":"column-267","name":"USER_ID","name_without_path":"USER_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t16","name":"DIGITAL.DIGITAL_USERS","name_show_schema":"DIGITAL.DIGITAL_USERS"}],"linked_lookup":null},{"id":"column-266","object_id":"column-266","name":"SESSION_TOKEN","name_without_path":"SESSION_TOKEN","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-265","object_id":"column-265","name":"DEVICE_TYPE","name_without_path":"DEVICE_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-264","object_id":"column-264","name":"DEVICE_ID","name_without_path":"DEVICE_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-263","object_id":"column-263","name":"IP_ADDRESS","name_without_path":"IP_ADDRESS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"45","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-262","object_id":"column-262","name":"USER_AGENT","name_without_path":"USER_AGENT","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-261","object_id":"column-261","name":"START_TIME","name_without_path":"START_TIME","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-260","object_id":"column-260","name":"LAST_ACTIVITY","name_without_path":"LAST_ACTIVITY","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-259","object_id":"column-259","name":"END_TIME","name_without_path":"END_TIME","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-258","object_id":"column-258","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_USER_SESSIONS_USER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.USER_SESSIONS","foreign_table_show_schema":"DIGITAL.USER_SESSIONS","foreign_table_verbose":"DIGITAL.USER_SESSIONS","foreign_table_verbose_show_schema":"DIGITAL.USER_SESSIONS","foreign_table_object_id":"t3","primary_table":"DIGITAL.DIGITAL_USERS","primary_table_show_schema":"DIGITAL.DIGITAL_USERS","primary_table_verbose":"DIGITAL.DIGITAL_USERS","primary_table_verbose_show_schema":"DIGITAL.DIGITAL_USERS","primary_table_object_id":"t16","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"USER_ID","foreign_column_path":null,"foreign_column":"USER_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_USER_SESSIONS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"SESSION_ID","name":"SESSION_ID","column_id":268}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[{"object_name":"DIGITAL.USER_SESSIONS","object_name_show_schema":"DIGITAL.USER_SESSIONS","object_type":"TABLE","object_id":"t3","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"DIGITAL.DIGITAL_USERS","object_name_show_schema":"DIGITAL.DIGITAL_USERS","object_type":"TABLE","object_id":"t16","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}],"used_by":[]},"object_id":"t3","name":"DIGITAL.USER_SESSIONS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"DIGITAL"},{"field":"Name","value":"USER_SESSIONS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t11": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-39","object_id":"column-39","name":"CUSTOMER_ID","name_without_path":"CUSTOMER_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-38","object_id":"column-38","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-37","object_id":"column-37","name":"CUSTOMER_NUMBER","name_without_path":"CUSTOMER_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-36","object_id":"column-36","name":"CUSTOMER_TYPE","name_without_path":"CUSTOMER_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-35","object_id":"column-35","name":"FIRST_NAME","name_without_path":"FIRST_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-34","object_id":"column-34","name":"LAST_NAME","name_without_path":"LAST_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-33","object_id":"column-33","name":"BUSINESS_NAME","name_without_path":"BUSINESS_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-32","object_id":"column-32","name":"DATE_OF_BIRTH","name_without_path":"DATE_OF_BIRTH","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-31","object_id":"column-31","name":"SSN_ENCRYPTED","name_without_path":"SSN_ENCRYPTED","description":null,"is_pk":false,"is_identity":false,"data_type":"varbinary","data_length":"256","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-30","object_id":"column-30","name":"EIN_ENCRYPTED","name_without_path":"EIN_ENCRYPTED","description":null,"is_pk":false,"is_identity":false,"data_type":"varbinary","data_length":"256","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-29","object_id":"column-29","name":"EMAIL","name_without_path":"EMAIL","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"250","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-28","object_id":"column-28","name":"PHONE","name_without_path":"PHONE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-27","object_id":"column-27","name":"ADDRESS","name_without_path":"ADDRESS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-26","object_id":"column-26","name":"CITY","name_without_path":"CITY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-25","object_id":"column-25","name":"STATE","name_without_path":"STATE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-24","object_id":"column-24","name":"ZIP_CODE","name_without_path":"ZIP_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-23","object_id":"column-23","name":"CREDIT_SCORE","name_without_path":"CREDIT_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-22","object_id":"column-22","name":"RISK_RATING","name_without_path":"RISK_RATING","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Medium'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-21","object_id":"column-21","name":"KYC_STATUS","name_without_path":"KYC_STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Pending'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-20","object_id":"column-20","name":"CUSTOMER_SINCE","name_without_path":"CUSTOMER_SINCE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-19","object_id":"column-19","name":"LAST_LOGIN_DATE","name_without_path":"LAST_LOGIN_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-18","object_id":"column-18","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-17","object_id":"column-17","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_CUSTOMERS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.CUSTOMERS","foreign_table_show_schema":"CORE.CUSTOMERS","foreign_table_verbose":"CORE.CUSTOMERS","foreign_table_verbose_show_schema":"CORE.CUSTOMERS","foreign_table_object_id":"t11","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_ACCOUNTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_BILL_PAY_PAYEES_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.BILL_PAY_PAYEES","foreign_table_show_schema":"DIGITAL.BILL_PAY_PAYEES","foreign_table_verbose":"DIGITAL.BILL_PAY_PAYEES","foreign_table_verbose_show_schema":"DIGITAL.BILL_PAY_PAYEES","foreign_table_object_id":"t15","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_DIGITAL_USERS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"DIGITAL.DIGITAL_USERS","foreign_table_show_schema":"DIGITAL.DIGITAL_USERS","foreign_table_verbose":"DIGITAL.DIGITAL_USERS","foreign_table_verbose_show_schema":"DIGITAL.DIGITAL_USERS","foreign_table_object_id":"t16","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_RISK_EVENTS_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}},{"name":"FK_SANCTIONS_SCREENING_CUSTOMER","title":null,"description":null,"is_user_defined":false,"foreign_table":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_verbose":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_verbose_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","foreign_table_object_id":"t19","primary_table":"CORE.CUSTOMERS","primary_table_show_schema":"CORE.CUSTOMERS","primary_table_verbose":"CORE.CUSTOMERS","primary_table_verbose_show_schema":"CORE.CUSTOMERS","primary_table_object_id":"t11","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CUSTOMER_ID","foreign_column_path":null,"foreign_column":"CUSTOMER_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_CUSTOMERS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"CUSTOMER_ID","name":"CUSTOMER_ID","column_id":39}],"custom_fields":{}},{"name":"UQ_CUSTOMERS_NUMBER","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_ID","name":"INSTITUTION_ID","column_id":38},{"path":null,"name_without_path":"CUSTOMER_NUMBER","name":"CUSTOMER_NUMBER","column_id":37}],"custom_fields":{}}],"triggers":[{"name":"TR_CUSTOMERS_CHANGE","description":null,"action":"After Insert Update ","script":"-- Additional trigger for CORE.CUSTOMERS (for KYC/AML compliance)\r\nCREATE   TRIGGER TR_CUSTOMERS_CHANGE\r\nON CORE.CUSTOMERS\r\nAFTER INSERT, UPDATE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @op_type NVARCHAR(10) = CASE \r\n        WHEN EXISTS(SELECT * FROM deleted) THEN 'UPDATE' \r\n        ELSE 'INSERT' \r\n    END;\r\n    \r\n    INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n        TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n        BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n    )\r\n    SELECT \r\n        'CORE', 'CUSTOMERS', @op_type,\r\n        CAST(CUSTOMER_ID AS NVARCHAR(100)),\r\n        CAST(GETDATE() AS DATE),\r\n        CASE \r\n            WHEN KYC_STATUS = 'Failed' OR RISK_RATING = 'High' THEN 'HIGH'\r\n            WHEN KYC_STATUS = 'Pending' THEN 'MEDIUM'\r\n            ELSE 'LOW'\r\n        END,\r\n        CASE \r\n            WHEN @op_type = 'INSERT' THEN\r\n                (SELECT \r\n                    outer_ins.CUSTOMER_ID,\r\n                    outer_ins.INSTITUTION_ID,\r\n                    outer_ins.CUSTOMER_NUMBER,\r\n                    outer_ins.CUSTOMER_TYPE,\r\n                    outer_ins.KYC_STATUS,\r\n                    outer_ins.RISK_RATING,\r\n                    outer_ins.CUSTOMER_SINCE,\r\n                    outer_ins.STATUS\r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n            ELSE\r\n                CONCAT(\r\n                    '{\"operation\":\"UPDATE\",\"old_values\":',\r\n                    (SELECT \r\n                        d.CUSTOMER_ID,\r\n                        d.KYC_STATUS,\r\n                        d.RISK_RATING,\r\n                        d.STATUS\r\n                     FROM deleted d \r\n                     WHERE d.CUSTOMER_ID = outer_ins.CUSTOMER_ID \r\n                     FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                    ',\"new_values\":',\r\n                    (SELECT \r\n                        outer_ins.CUSTOMER_ID,\r\n                        outer_ins.KYC_STATUS,\r\n                        outer_ins.RISK_RATING,\r\n                        outer_ins.STATUS\r\n                     FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                    '}'\r\n                )\r\n        END\r\n    FROM inserted outer_ins;\r\nEND;","custom_fields":{}},{"name":"TR_CUSTOMERS_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_CUSTOMERS_EventLog\r\nON CORE.CUSTOMERS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'CUSTOMERS',\r\n            'INSERT',\r\n            CAST(CUSTOMER_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.CUSTOMER_ID = inserted.CUSTOMER_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'CUSTOMERS',\r\n            'UPDATE',\r\n            CAST(i.CUSTOMER_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.CUSTOMER_ID = i.CUSTOMER_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.CUSTOMER_ID = i.CUSTOMER_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'CORE',\r\n            'CUSTOMERS',\r\n            'DELETE',\r\n            CAST(CUSTOMER_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.CUSTOMER_ID = deleted.CUSTOMER_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"CORE.TR_CUSTOMERS_CHANGE","object_name_show_schema":"CORE.TR_CUSTOMERS_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.TR_CUSTOMERS_EventLog","object_name_show_schema":"CORE.TR_CUSTOMERS_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"COMPLIANCE.SANCTIONS_SCREENING","object_name_show_schema":"COMPLIANCE.SANCTIONS_SCREENING","object_type":"TABLE","object_id":"t19","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"DIGITAL.BILL_PAY_PAYEES","object_name_show_schema":"DIGITAL.BILL_PAY_PAYEES","object_type":"TABLE","object_id":"t15","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"DIGITAL.DIGITAL_USERS","object_name_show_schema":"DIGITAL.DIGITAL_USERS","object_type":"TABLE","object_id":"t16","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"RISK.RISK_EVENTS","object_name_show_schema":"RISK.RISK_EVENTS","object_type":"TABLE","object_id":"t14","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t11","name":"CORE.CUSTOMERS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CORE"},{"field":"Name","value":"CUSTOMERS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f3": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f3","name":"cdc.fn_cdc_get_all_changes_CARDS_CARD_TRANSACTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_CARDS_CARD_TRANSACTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_CARDS_CARD_TRANSACTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [CARD_TRANSACTION_ID], NULL as [CARD_ACCOUNT_ID], NULL as [TRANSACTION_TYPE], NULL as [AMOUNT], NULL as [CURRENCY], NULL as [MERCHANT_NAME], NULL as [MERCHANT_CATEGORY], NULL as [MERCHANT_ID], NULL as [TRANSACTION_DATE], NULL as [POSTING_DATE], NULL as [AUTHORIZATION_CODE], NULL as [NETWORK_TRANSACTION_ID], NULL as [STATUS], NULL as [DECLINE_REASON], NULL as [LOCATION], NULL as [COUNTRY], NULL as [RISK_SCORE], NULL as [FRAUD_FLAG], NULL as [REWARDS_EARNED], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CARD_TRANSACTION_ID], t.[CARD_ACCOUNT_ID], t.[TRANSACTION_TYPE], t.[AMOUNT], t.[CURRENCY], t.[MERCHANT_NAME], t.[MERCHANT_CATEGORY], t.[MERCHANT_ID], t.[TRANSACTION_DATE], t.[POSTING_DATE], t.[AUTHORIZATION_CODE], t.[NETWORK_TRANSACTION_ID], t.[STATUS], t.[DECLINE_REASON], t.[LOCATION], t.[COUNTRY], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[REWARDS_EARNED], t.[CREATED_DATE]\r\n\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[CARD_TRANSACTION_ID], t.[CARD_ACCOUNT_ID], t.[TRANSACTION_TYPE], t.[AMOUNT], t.[CURRENCY], t.[MERCHANT_NAME], t.[MERCHANT_CATEGORY], t.[MERCHANT_ID], t.[TRANSACTION_DATE], t.[POSTING_DATE], t.[AUTHORIZATION_CODE], t.[NETWORK_TRANSACTION_ID], t.[STATUS], t.[DECLINE_REASON], t.[LOCATION], t.[COUNTRY], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[REWARDS_EARNED], t.[CREATED_DATE]\r\n\tfrom [cdc].[CARDS_CARD_TRANSACTIONS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'CARDS_CARD_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"d1f": {"functions":[{"id":"f2","name":"cdc.fn_cdc_get_all_changes_CARDS_CARD_ACCOUNTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f3","name":"cdc.fn_cdc_get_all_changes_CARDS_CARD_TRANSACTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f17","name":"cdc.fn_cdc_get_all_changes_COMPLIANCE_REGULATORY_REPORTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f4","name":"cdc.fn_cdc_get_all_changes_COMPLIANCE_SANCTIONS_SCREENING","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f9","name":"cdc.fn_cdc_get_all_changes_CORE_ACCOUNTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f22","name":"cdc.fn_cdc_get_all_changes_CORE_CUSTOMERS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f15","name":"cdc.fn_cdc_get_all_changes_CORE_FINANCIAL_INSTITUTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f20","name":"cdc.fn_cdc_get_all_changes_CORE_PRODUCT_TYPES","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f21","name":"cdc.fn_cdc_get_all_changes_DIGITAL_DIGITAL_USERS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f14","name":"cdc.fn_cdc_get_all_changes_PAYMENTS_PAYMENT_NETWORKS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f11","name":"cdc.fn_cdc_get_all_changes_PAYMENTS_TRANSACTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f5","name":"cdc.fn_cdc_get_all_changes_RISK_RISK_EVENTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f7","name":"cdc.fn_cdc_get_net_changes_CARDS_CARD_ACCOUNTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f23","name":"cdc.fn_cdc_get_net_changes_CARDS_CARD_TRANSACTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f1","name":"cdc.fn_cdc_get_net_changes_COMPLIANCE_REGULATORY_REPORTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f12","name":"cdc.fn_cdc_get_net_changes_COMPLIANCE_SANCTIONS_SCREENING","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f16","name":"cdc.fn_cdc_get_net_changes_CORE_ACCOUNTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f19","name":"cdc.fn_cdc_get_net_changes_CORE_CUSTOMERS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f18","name":"cdc.fn_cdc_get_net_changes_CORE_FINANCIAL_INSTITUTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f24","name":"cdc.fn_cdc_get_net_changes_CORE_PRODUCT_TYPES","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f6","name":"cdc.fn_cdc_get_net_changes_DIGITAL_DIGITAL_USERS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f13","name":"cdc.fn_cdc_get_net_changes_PAYMENTS_PAYMENT_NETWORKS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f8","name":"cdc.fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}},{"id":"f10","name":"cdc.fn_cdc_get_net_changes_RISK_RISK_EVENTS","type":"FUNCTION","subtype":"FUNCTION","is_user_defined":false,"custom_fields":{"Status":{"value":null,"type":"LIST_CLOSED"},"Owner":{"value":"","type":"USER"}}}],"object_id":"d1f","title_prefix":null,"custom_fields":[]},"t10": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-288","object_id":"column-288","name":"CARD_TRANSACTION_ID","name_without_path":"CARD_TRANSACTION_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-287","object_id":"column-287","name":"CARD_ACCOUNT_ID","name_without_path":"CARD_ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t12","name":"CARDS.CARD_ACCOUNTS","name_show_schema":"CARDS.CARD_ACCOUNTS"}],"linked_lookup":null},{"id":"column-286","object_id":"column-286","name":"TRANSACTION_TYPE","name_without_path":"TRANSACTION_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-285","object_id":"column-285","name":"AMOUNT","name_without_path":"AMOUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-284","object_id":"column-284","name":"CURRENCY","name_without_path":"CURRENCY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"3","is_nullable":true,"computed_formula":null,"default_value":"'USD'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-283","object_id":"column-283","name":"MERCHANT_NAME","name_without_path":"MERCHANT_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-282","object_id":"column-282","name":"MERCHANT_CATEGORY","name_without_path":"MERCHANT_CATEGORY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-281","object_id":"column-281","name":"MERCHANT_ID","name_without_path":"MERCHANT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-280","object_id":"column-280","name":"TRANSACTION_DATE","name_without_path":"TRANSACTION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-279","object_id":"column-279","name":"POSTING_DATE","name_without_path":"POSTING_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-278","object_id":"column-278","name":"AUTHORIZATION_CODE","name_without_path":"AUTHORIZATION_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-277","object_id":"column-277","name":"NETWORK_TRANSACTION_ID","name_without_path":"NETWORK_TRANSACTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-276","object_id":"column-276","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Pending'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-275","object_id":"column-275","name":"DECLINE_REASON","name_without_path":"DECLINE_REASON","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-274","object_id":"column-274","name":"LOCATION","name_without_path":"LOCATION","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-273","object_id":"column-273","name":"COUNTRY","name_without_path":"COUNTRY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-272","object_id":"column-272","name":"RISK_SCORE","name_without_path":"RISK_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-271","object_id":"column-271","name":"FRAUD_FLAG","name_without_path":"FRAUD_FLAG","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-270","object_id":"column-270","name":"REWARDS_EARNED","name_without_path":"REWARDS_EARNED","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-269","object_id":"column-269","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_CARD_TRANSACTIONS_CARD_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_TRANSACTIONS","foreign_table_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose":"CARDS.CARD_TRANSACTIONS","foreign_table_verbose_show_schema":"CARDS.CARD_TRANSACTIONS","foreign_table_object_id":"t10","primary_table":"CARDS.CARD_ACCOUNTS","primary_table_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_verbose":"CARDS.CARD_ACCOUNTS","primary_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","primary_table_object_id":"t12","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"CARD_ACCOUNT_ID","foreign_column_path":null,"foreign_column":"CARD_ACCOUNT_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_CARD_TRANSACTIONS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"CARD_TRANSACTION_ID","name":"CARD_TRANSACTION_ID","column_id":288}],"custom_fields":{}}],"triggers":[{"name":"TR_CARD_TRANSACTIONS_CHANGE","description":null,"action":"After Insert Update ","script":"-- High-priority trigger for CARDS.CARD_TRANSACTIONS (fraud detection)\r\nCREATE   TRIGGER TR_CARD_TRANSACTIONS_CHANGE\r\nON CARDS.CARD_TRANSACTIONS\r\nAFTER INSERT, UPDATE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @operation_type NVARCHAR(10) = CASE \r\n        WHEN EXISTS(SELECT * FROM deleted) THEN 'UPDATE' \r\n        ELSE 'INSERT' \r\n    END;\r\n    \r\n    IF @operation_type = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'CARDS', 'CARD_TRANSACTIONS', 'INSERT',\r\n            CAST(CARD_TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN FRAUD_FLAG = 1 OR AMOUNT >= 5000 THEN 'HIGH'\r\n                WHEN AMOUNT >= 500 THEN 'MEDIUM'\r\n                ELSE 'LOW'\r\n            END,\r\n            (SELECT \r\n                outer_ins.CARD_TRANSACTION_ID,\r\n                outer_ins.CARD_ACCOUNT_ID,\r\n                outer_ins.TRANSACTION_TYPE,\r\n                outer_ins.AMOUNT,\r\n                outer_ins.MERCHANT_NAME,\r\n                outer_ins.TRANSACTION_DATE,\r\n                outer_ins.STATUS,\r\n                outer_ins.FRAUD_FLAG,\r\n                outer_ins.RISK_SCORE\r\n             FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n        FROM inserted outer_ins;\r\n    END\r\n    ELSE\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'CARDS', 'CARD_TRANSACTIONS', 'UPDATE',\r\n            CAST(i.CARD_TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(i.TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN i.FRAUD_FLAG = 1 OR i.AMOUNT >= 5000 THEN 'HIGH'\r\n                WHEN i.AMOUNT >= 500 THEN 'MEDIUM'\r\n                ELSE 'LOW'\r\n            END,\r\n            CONCAT(\r\n                '{\"operation\":\"UPDATE\",\"old_values\":',\r\n                (SELECT \r\n                    d.CARD_TRANSACTION_ID,\r\n                    d.STATUS,\r\n                    d.AMOUNT,\r\n                    d.FRAUD_FLAG\r\n                 FROM deleted d \r\n                 WHERE d.CARD_TRANSACTION_ID = i.CARD_TRANSACTION_ID \r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                ',\"new_values\":',\r\n                (SELECT \r\n                    i.CARD_TRANSACTION_ID,\r\n                    i.STATUS,\r\n                    i.AMOUNT,\r\n                    i.FRAUD_FLAG\r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                '}'\r\n            )\r\n        FROM inserted i;\r\n    END\r\nEND;","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CARDS.CARD_TRANSACTIONS","object_name_show_schema":"CARDS.CARD_TRANSACTIONS","object_type":"TABLE","object_id":"t10","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"CARDS.TR_CARD_TRANSACTIONS_CHANGE","object_name_show_schema":"CARDS.TR_CARD_TRANSACTIONS_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[]},"object_id":"t10","name":"CARDS.CARD_TRANSACTIONS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CARDS"},{"field":"Name","value":"CARD_TRANSACTIONS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f1": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f1","name":"cdc.fn_cdc_get_net_changes_COMPLIANCE_REGULATORY_REPORTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_COMPLIANCE_REGULATORY_REPORTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_COMPLIANCE_REGULATORY_REPORTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [REPORT_ID], NULL as [INSTITUTION_ID], NULL as [REPORT_TYPE], NULL as [REPORTING_PERIOD], NULL as [REGULATOR_ID], NULL as [STATUS], NULL as [SUBMISSION_DATE], NULL as [DUE_DATE], NULL as [FILE_PATH], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_732F91FD\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_732F91FD \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [REPORT_ID], [INSTITUTION_ID], [REPORT_TYPE], [REPORTING_PERIOD], [REGULATOR_ID], [STATUS], [SUBMISSION_DATE], [DUE_DATE], [FILE_PATH], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_732F91FD \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_732F91FD, __$count_732F91FD, t.[REPORT_ID], t.[INSTITUTION_ID], t.[REPORT_TYPE], t.[REPORTING_PERIOD], t.[REGULATOR_ID], t.[STATUS], t.[SUBMISSION_DATE], t.[DUE_DATE], t.[FILE_PATH], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[REPORT_ID],\r\n\t\t    count(*) as __$count_732F91FD \r\n\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[REPORT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock) where  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[REPORT_ID] = m.[REPORT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[REPORT_ID] = mo.[REPORT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_732F91FD\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_732F91FD \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_732F91FD\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_732F91FD \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [REPORT_ID], [INSTITUTION_ID], [REPORT_TYPE], [REPORTING_PERIOD], [REGULATOR_ID], [STATUS], [SUBMISSION_DATE], [DUE_DATE], [FILE_PATH], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_732F91FD \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_732F91FD, __$count_732F91FD, \r\n\t\tm.__$update_mask , t.[REPORT_ID], t.[INSTITUTION_ID], t.[REPORT_TYPE], t.[REPORTING_PERIOD], t.[REGULATOR_ID], t.[STATUS], t.[SUBMISSION_DATE], t.[DUE_DATE], t.[FILE_PATH], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[REPORT_ID],\r\n\t\t    count(*) as __$count_732F91FD, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[REPORT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock) where  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[REPORT_ID] = m.[REPORT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[REPORT_ID] = mo.[REPORT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[REPORT_ID], t.[INSTITUTION_ID], t.[REPORT_TYPE], t.[REPORTING_PERIOD], t.[REGULATOR_ID], t.[STATUS], t.[SUBMISSION_DATE], t.[DUE_DATE], t.[FILE_PATH], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock) where  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[REPORT_ID] = t.[REPORT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[REPORT_ID] = mo.[REPORT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f24": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f24","name":"cdc.fn_cdc_get_net_changes_CORE_PRODUCT_TYPES","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_CORE_PRODUCT_TYPES"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_CORE_PRODUCT_TYPES]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [PRODUCT_TYPE_ID], NULL as [PRODUCT_CODE], NULL as [PRODUCT_NAME], NULL as [PRODUCT_CATEGORY], NULL as [INTEREST_RATE], NULL as [MINIMUM_BALANCE], NULL as [MONTHLY_FEE], NULL as [OVERDRAFT_FEE], NULL as [IS_ACTIVE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_86B14F7C\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_86B14F7C \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [PRODUCT_TYPE_ID], [PRODUCT_CODE], [PRODUCT_NAME], [PRODUCT_CATEGORY], [INTEREST_RATE], [MINIMUM_BALANCE], [MONTHLY_FEE], [OVERDRAFT_FEE], [IS_ACTIVE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_86B14F7C \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_86B14F7C, __$count_86B14F7C, t.[PRODUCT_TYPE_ID], t.[PRODUCT_CODE], t.[PRODUCT_NAME], t.[PRODUCT_CATEGORY], t.[INTEREST_RATE], t.[MINIMUM_BALANCE], t.[MONTHLY_FEE], t.[OVERDRAFT_FEE], t.[IS_ACTIVE] \r\n\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[PRODUCT_TYPE_ID],\r\n\t\t    count(*) as __$count_86B14F7C \r\n\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[PRODUCT_TYPE_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock) where  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[PRODUCT_TYPE_ID] = m.[PRODUCT_TYPE_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_PRODUCT_TYPES_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[PRODUCT_TYPE_ID] = mo.[PRODUCT_TYPE_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_86B14F7C\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_86B14F7C \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_86B14F7C\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_86B14F7C \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [PRODUCT_TYPE_ID], [PRODUCT_CODE], [PRODUCT_NAME], [PRODUCT_CATEGORY], [INTEREST_RATE], [MINIMUM_BALANCE], [MONTHLY_FEE], [OVERDRAFT_FEE], [IS_ACTIVE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_86B14F7C \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_86B14F7C, __$count_86B14F7C, \r\n\t\tm.__$update_mask , t.[PRODUCT_TYPE_ID], t.[PRODUCT_CODE], t.[PRODUCT_NAME], t.[PRODUCT_CATEGORY], t.[INTEREST_RATE], t.[MINIMUM_BALANCE], t.[MONTHLY_FEE], t.[OVERDRAFT_FEE], t.[IS_ACTIVE]\r\n\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[PRODUCT_TYPE_ID],\r\n\t\t    count(*) as __$count_86B14F7C, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[PRODUCT_TYPE_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock) where  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[PRODUCT_TYPE_ID] = m.[PRODUCT_TYPE_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_PRODUCT_TYPES_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[PRODUCT_TYPE_ID] = mo.[PRODUCT_TYPE_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[PRODUCT_TYPE_ID], t.[PRODUCT_CODE], t.[PRODUCT_NAME], t.[PRODUCT_CATEGORY], t.[INTEREST_RATE], t.[MINIMUM_BALANCE], t.[MONTHLY_FEE], t.[OVERDRAFT_FEE], t.[IS_ACTIVE]\r\n\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'CORE_PRODUCT_TYPES', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock) where  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[CORE_PRODUCT_TYPES_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[PRODUCT_TYPE_ID] = t.[PRODUCT_TYPE_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[CORE_PRODUCT_TYPES_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[PRODUCT_TYPE_ID] = mo.[PRODUCT_TYPE_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f14": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f14","name":"cdc.fn_cdc_get_all_changes_PAYMENTS_PAYMENT_NETWORKS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_PAYMENTS_PAYMENT_NETWORKS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_PAYMENTS_PAYMENT_NETWORKS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [NETWORK_ID], NULL as [NETWORK_CODE], NULL as [NETWORK_NAME], NULL as [NETWORK_TYPE], NULL as [PROCESSING_FEE], NULL as [SETTLEMENT_TIME], NULL as [MAX_TRANSACTION_AMOUNT], NULL as [IS_ACTIVE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[NETWORK_ID], t.[NETWORK_CODE], t.[NETWORK_NAME], t.[NETWORK_TYPE], t.[PROCESSING_FEE], t.[SETTLEMENT_TIME], t.[MAX_TRANSACTION_AMOUNT], t.[IS_ACTIVE]\r\n\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[NETWORK_ID], t.[NETWORK_CODE], t.[NETWORK_NAME], t.[NETWORK_TYPE], t.[PROCESSING_FEE], t.[SETTLEMENT_TIME], t.[MAX_TRANSACTION_AMOUNT], t.[IS_ACTIVE]\r\n\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t21": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-104","object_id":"column-104","name":"NETWORK_ID","name_without_path":"NETWORK_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-103","object_id":"column-103","name":"NETWORK_CODE","name_without_path":"NETWORK_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-102","object_id":"column-102","name":"NETWORK_NAME","name_without_path":"NETWORK_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-101","object_id":"column-101","name":"NETWORK_TYPE","name_without_path":"NETWORK_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-100","object_id":"column-100","name":"PROCESSING_FEE","name_without_path":"PROCESSING_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-99","object_id":"column-99","name":"SETTLEMENT_TIME","name_without_path":"SETTLEMENT_TIME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-98","object_id":"column-98","name":"MAX_TRANSACTION_AMOUNT","name_without_path":"MAX_TRANSACTION_AMOUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"15, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-97","object_id":"column-97","name":"IS_ACTIVE","name_without_path":"IS_ACTIVE","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"1","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_TRANSACTIONS_NETWORK","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"PAYMENTS.PAYMENT_NETWORKS","primary_table_show_schema":"PAYMENTS.PAYMENT_NETWORKS","primary_table_verbose":"PAYMENTS.PAYMENT_NETWORKS","primary_table_verbose_show_schema":"PAYMENTS.PAYMENT_NETWORKS","primary_table_object_id":"t21","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"NETWORK_ID","foreign_column_path":null,"foreign_column":"NETWORK_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_PAYMENT_NETWORKS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"NETWORK_ID","name":"NETWORK_ID","column_id":104}],"custom_fields":{}},{"name":"UQ_PAYMENT_NETWORKS_CODE","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"NETWORK_CODE","name":"NETWORK_CODE","column_id":103}],"custom_fields":{}}],"triggers":[{"name":"TR_PAYMENT_NETWORKS_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_PAYMENT_NETWORKS_EventLog\r\nON PAYMENTS.PAYMENT_NETWORKS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'PAYMENT_NETWORKS',\r\n            'INSERT',\r\n            CAST(NETWORK_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.NETWORK_ID = inserted.NETWORK_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'PAYMENT_NETWORKS',\r\n            'UPDATE',\r\n            CAST(i.NETWORK_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.NETWORK_ID = i.NETWORK_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.NETWORK_ID = i.NETWORK_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'PAYMENT_NETWORKS',\r\n            'DELETE',\r\n            CAST(NETWORK_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.NETWORK_ID = deleted.NETWORK_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"PAYMENTS.TR_PAYMENT_NETWORKS_EventLog","object_name_show_schema":"PAYMENTS.TR_PAYMENT_NETWORKS_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"PAYMENTS.PAYMENT_NETWORKS","object_name_show_schema":"PAYMENTS.PAYMENT_NETWORKS","object_type":"TABLE","object_id":"t21","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"PAYMENTS.TRANSACTIONS","object_name_show_schema":"PAYMENTS.TRANSACTIONS","object_type":"TABLE","object_id":"t6","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t21","name":"PAYMENTS.PAYMENT_NETWORKS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"PAYMENTS"},{"field":"Name","value":"PAYMENT_NETWORKS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t7": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-176","object_id":"column-176","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-175","object_id":"column-175","name":"INSTITUTION_CODE","name_without_path":"INSTITUTION_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-174","object_id":"column-174","name":"INSTITUTION_NAME","name_without_path":"INSTITUTION_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-173","object_id":"column-173","name":"INSTITUTION_TYPE","name_without_path":"INSTITUTION_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-172","object_id":"column-172","name":"ROUTING_NUMBER","name_without_path":"ROUTING_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"9","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-171","object_id":"column-171","name":"SWIFT_CODE","name_without_path":"SWIFT_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"11","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-170","object_id":"column-170","name":"ADDRESS","name_without_path":"ADDRESS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-169","object_id":"column-169","name":"CITY","name_without_path":"CITY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-168","object_id":"column-168","name":"STATE","name_without_path":"STATE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-167","object_id":"column-167","name":"ZIP_CODE","name_without_path":"ZIP_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-166","object_id":"column-166","name":"COUNTRY","name_without_path":"COUNTRY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":"'USA'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-165","object_id":"column-165","name":"REGULATION_LEVEL","name_without_path":"REGULATION_LEVEL","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-164","object_id":"column-164","name":"ASSETS_UNDER_MANAGEMENT","name_without_path":"ASSETS_UNDER_MANAGEMENT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"18, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-163","object_id":"column-163","name":"CUSTOMER_COUNT","name_without_path":"CUSTOMER_COUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"bigint","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-162","object_id":"column-162","name":"PLATFORM_ONBOARD_DATE","name_without_path":"PLATFORM_ONBOARD_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-161","object_id":"column-161","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Active'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-160","object_id":"column-160","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_ACCOUNTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_CARD_ACCOUNTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CARDS.CARD_ACCOUNTS","foreign_table_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_verbose":"CARDS.CARD_ACCOUNTS","foreign_table_verbose_show_schema":"CARDS.CARD_ACCOUNTS","foreign_table_object_id":"t12","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_CUSTOMERS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.CUSTOMERS","foreign_table_show_schema":"CORE.CUSTOMERS","foreign_table_verbose":"CORE.CUSTOMERS","foreign_table_verbose_show_schema":"CORE.CUSTOMERS","foreign_table_object_id":"t11","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_DAILY_METRICS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"ANALYTICS.DAILY_METRICS","foreign_table_show_schema":"ANALYTICS.DAILY_METRICS","foreign_table_verbose":"ANALYTICS.DAILY_METRICS","foreign_table_verbose_show_schema":"ANALYTICS.DAILY_METRICS","foreign_table_object_id":"t13","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_REGULATORY_REPORTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_show_schema":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_verbose":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_verbose_show_schema":"COMPLIANCE.REGULATORY_REPORTS","foreign_table_object_id":"t1","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_RISK_EVENTS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"RISK.RISK_EVENTS","foreign_table_show_schema":"RISK.RISK_EVENTS","foreign_table_verbose":"RISK.RISK_EVENTS","foreign_table_verbose_show_schema":"RISK.RISK_EVENTS","foreign_table_object_id":"t14","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_FINANCIAL_INSTITUTIONS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_ID","name":"INSTITUTION_ID","column_id":176}],"custom_fields":{}},{"name":"UQ_FINANCIAL_INSTITUTIONS_CODE","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_CODE","name":"INSTITUTION_CODE","column_id":175}],"custom_fields":{}},{"name":"UQ_FINANCIAL_INSTITUTIONS_ROUTING","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"ROUTING_NUMBER","name":"ROUTING_NUMBER","column_id":172}],"custom_fields":{}}],"triggers":[{"name":"TR_FINANCIAL_INSTITUTIONS_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_FINANCIAL_INSTITUTIONS_EventLog\r\nON CORE.FINANCIAL_INSTITUTIONS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'FINANCIAL_INSTITUTIONS',\r\n            'INSERT',\r\n            CAST(INSTITUTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.INSTITUTION_ID = inserted.INSTITUTION_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'FINANCIAL_INSTITUTIONS',\r\n            'UPDATE',\r\n            CAST(i.INSTITUTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.INSTITUTION_ID = i.INSTITUTION_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.INSTITUTION_ID = i.INSTITUTION_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'CORE',\r\n            'FINANCIAL_INSTITUTIONS',\r\n            'DELETE',\r\n            CAST(INSTITUTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.INSTITUTION_ID = deleted.INSTITUTION_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CORE.TR_FINANCIAL_INSTITUTIONS_EventLog","object_name_show_schema":"CORE.TR_FINANCIAL_INSTITUTIONS_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"ANALYTICS.DAILY_METRICS","object_name_show_schema":"ANALYTICS.DAILY_METRICS","object_type":"TABLE","object_id":"t13","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CARDS.CARD_ACCOUNTS","object_name_show_schema":"CARDS.CARD_ACCOUNTS","object_type":"TABLE","object_id":"t12","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"COMPLIANCE.REGULATORY_REPORTS","object_name_show_schema":"COMPLIANCE.REGULATORY_REPORTS","object_type":"TABLE","object_id":"t1","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.CUSTOMERS","object_name_show_schema":"CORE.CUSTOMERS","object_type":"TABLE","object_id":"t11","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"PAYMENTS.TRANSACTIONS","object_name_show_schema":"PAYMENTS.TRANSACTIONS","object_type":"TABLE","object_id":"t6","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"RISK.RISK_EVENTS","object_name_show_schema":"RISK.RISK_EVENTS","object_type":"TABLE","object_id":"t14","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CORE"},{"field":"Name","value":"FINANCIAL_INSTITUTIONS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f17": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f17","name":"cdc.fn_cdc_get_all_changes_COMPLIANCE_REGULATORY_REPORTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_COMPLIANCE_REGULATORY_REPORTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_COMPLIANCE_REGULATORY_REPORTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [REPORT_ID], NULL as [INSTITUTION_ID], NULL as [REPORT_TYPE], NULL as [REPORTING_PERIOD], NULL as [REGULATOR_ID], NULL as [STATUS], NULL as [SUBMISSION_DATE], NULL as [DUE_DATE], NULL as [FILE_PATH], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[REPORT_ID], t.[INSTITUTION_ID], t.[REPORT_TYPE], t.[REPORTING_PERIOD], t.[REGULATOR_ID], t.[STATUS], t.[SUBMISSION_DATE], t.[DUE_DATE], t.[FILE_PATH], t.[CREATED_DATE]\r\n\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[REPORT_ID], t.[INSTITUTION_ID], t.[REPORT_TYPE], t.[REPORTING_PERIOD], t.[REGULATOR_ID], t.[STATUS], t.[SUBMISSION_DATE], t.[DUE_DATE], t.[FILE_PATH], t.[CREATED_DATE]\r\n\tfrom [cdc].[COMPLIANCE_REGULATORY_REPORTS_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_REGULATORY_REPORTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"t2": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-207","object_id":"column-207","name":"LOG_ID","name_without_path":"LOG_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"bigint","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-206","object_id":"column-206","name":"TABLE_SCHEMA","name_without_path":"TABLE_SCHEMA","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-205","object_id":"column-205","name":"TABLE_NAME","name_without_path":"TABLE_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-204","object_id":"column-204","name":"OPERATION_TYPE","name_without_path":"OPERATION_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"10","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-203","object_id":"column-203","name":"RECORD_ID","name_without_path":"RECORD_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-202","object_id":"column-202","name":"BUSINESS_DATE","name_without_path":"BUSINESS_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-201","object_id":"column-201","name":"PRIORITY_LEVEL","name_without_path":"PRIORITY_LEVEL","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'MEDIUM'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-200","object_id":"column-200","name":"CHANGE_DATA","name_without_path":"CHANGE_DATA","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"MAX","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-199","object_id":"column-199","name":"PROCESSING_STATUS","name_without_path":"PROCESSING_STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'PENDING'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-198","object_id":"column-198","name":"ADF_PIPELINE_TRIGGERED","name_without_path":"ADF_PIPELINE_TRIGGERED","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-197","object_id":"column-197","name":"CHANGE_TIMESTAMP","name_without_path":"CHANGE_TIMESTAMP","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-196","object_id":"column-196","name":"PROCESSED_TIMESTAMP","name_without_path":"PROCESSED_TIMESTAMP","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[],"unique_keys":[{"name":"PK__CHANGE_L__4364C882B1457248","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"LOG_ID","name":"LOG_ID","column_id":207}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"t2","name":"ADF_CONTROL.CHANGE_LOG","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"ADF_CONTROL"},{"field":"Name","value":"CHANGE_LOG"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t20": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-152","object_id":"column-152","name":"EventID","name_without_path":"EventID","description":null,"is_pk":true,"is_identity":true,"data_type":"bigint","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-151","object_id":"column-151","name":"TableName","name_without_path":"TableName","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"128","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-150","object_id":"column-150","name":"Operation","name_without_path":"Operation","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"10","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-149","object_id":"column-149","name":"RecordID","name_without_path":"RecordID","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-148","object_id":"column-148","name":"OldValues","name_without_path":"OldValues","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"MAX","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-147","object_id":"column-147","name":"NewValues","name_without_path":"NewValues","description":null,"is_pk":false,"is_identity":false,"data_type":"nvarchar","data_length":"MAX","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-146","object_id":"column-146","name":"ChangeDate","name_without_path":"ChangeDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getutcdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-145","object_id":"column-145","name":"Processed","name_without_path":"Processed","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-144","object_id":"column-144","name":"ProcessedDate","name_without_path":"ProcessedDate","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[],"unique_keys":[{"name":"PK__EventLog__7944C870F597DFD1","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"EventID","name":"EventID","column_id":152}],"custom_fields":{}}],"triggers":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"t20","name":"cdc.EventLog","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"EventLog"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f12": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f12","name":"cdc.fn_cdc_get_net_changes_COMPLIANCE_SANCTIONS_SCREENING","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_COMPLIANCE_SANCTIONS_SCREENING"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_COMPLIANCE_SANCTIONS_SCREENING]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [SCREENING_ID], NULL as [CUSTOMER_ID], NULL as [TRANSACTION_ID], NULL as [ENTITY_NAME], NULL as [SCREENING_TYPE], NULL as [MATCH_TYPE], NULL as [MATCH_SCORE], NULL as [LIST_NAME], NULL as [STATUS], NULL as [REVIEW_NOTES], NULL as [SCREENING_DATE], NULL as [REVIEWED_BY], NULL as [REVIEWED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_82D277C9\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_82D277C9 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [SCREENING_ID], [CUSTOMER_ID], [TRANSACTION_ID], [ENTITY_NAME], [SCREENING_TYPE], [MATCH_TYPE], [MATCH_SCORE], [LIST_NAME], [STATUS], [REVIEW_NOTES], [SCREENING_DATE], [REVIEWED_BY], [REVIEWED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_82D277C9 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_82D277C9, __$count_82D277C9, t.[SCREENING_ID], t.[CUSTOMER_ID], t.[TRANSACTION_ID], t.[ENTITY_NAME], t.[SCREENING_TYPE], t.[MATCH_TYPE], t.[MATCH_SCORE], t.[LIST_NAME], t.[STATUS], t.[REVIEW_NOTES], t.[SCREENING_DATE], t.[REVIEWED_BY], t.[REVIEWED_DATE] \r\n\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[SCREENING_ID],\r\n\t\t    count(*) as __$count_82D277C9 \r\n\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[SCREENING_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock) where  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[SCREENING_ID] = m.[SCREENING_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[SCREENING_ID] = mo.[SCREENING_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_82D277C9\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_82D277C9 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_82D277C9\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_82D277C9 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [SCREENING_ID], [CUSTOMER_ID], [TRANSACTION_ID], [ENTITY_NAME], [SCREENING_TYPE], [MATCH_TYPE], [MATCH_SCORE], [LIST_NAME], [STATUS], [REVIEW_NOTES], [SCREENING_DATE], [REVIEWED_BY], [REVIEWED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_82D277C9 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_82D277C9, __$count_82D277C9, \r\n\t\tm.__$update_mask , t.[SCREENING_ID], t.[CUSTOMER_ID], t.[TRANSACTION_ID], t.[ENTITY_NAME], t.[SCREENING_TYPE], t.[MATCH_TYPE], t.[MATCH_SCORE], t.[LIST_NAME], t.[STATUS], t.[REVIEW_NOTES], t.[SCREENING_DATE], t.[REVIEWED_BY], t.[REVIEWED_DATE]\r\n\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[SCREENING_ID],\r\n\t\t    count(*) as __$count_82D277C9, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[SCREENING_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock) where  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[SCREENING_ID] = m.[SCREENING_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[SCREENING_ID] = mo.[SCREENING_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[SCREENING_ID], t.[CUSTOMER_ID], t.[TRANSACTION_ID], t.[ENTITY_NAME], t.[SCREENING_TYPE], t.[MATCH_TYPE], t.[MATCH_SCORE], t.[LIST_NAME], t.[STATUS], t.[REVIEW_NOTES], t.[SCREENING_DATE], t.[REVIEWED_BY], t.[REVIEWED_DATE]\r\n\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock) where  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[SCREENING_ID] = t.[SCREENING_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[SCREENING_ID] = mo.[SCREENING_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f6": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f6","name":"cdc.fn_cdc_get_net_changes_DIGITAL_DIGITAL_USERS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_DIGITAL_DIGITAL_USERS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_DIGITAL_DIGITAL_USERS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [USER_ID], NULL as [CUSTOMER_ID], NULL as [USERNAME], NULL as [PASSWORD_HASH], NULL as [EMAIL], NULL as [MOBILE_PHONE], NULL as [LAST_LOGIN_DATE], NULL as [LOGIN_ATTEMPTS], NULL as [IS_LOCKED], NULL as [LOCKOUT_END_DATE], NULL as [TWO_FACTOR_ENABLED], NULL as [PREFERRED_NOTIFICATION_METHOD], NULL as [STATUS], NULL as [CREATED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BA7D5A31\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BA7D5A31 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [USER_ID], [CUSTOMER_ID], [USERNAME], [PASSWORD_HASH], [EMAIL], [MOBILE_PHONE], [LAST_LOGIN_DATE], [LOGIN_ATTEMPTS], [IS_LOCKED], [LOCKOUT_END_DATE], [TWO_FACTOR_ENABLED], [PREFERRED_NOTIFICATION_METHOD], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BA7D5A31 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[USER_ID] = t.[USER_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BA7D5A31, __$count_BA7D5A31, t.[USER_ID], t.[CUSTOMER_ID], t.[USERNAME], t.[PASSWORD_HASH], t.[EMAIL], t.[MOBILE_PHONE], t.[LAST_LOGIN_DATE], t.[LOGIN_ATTEMPTS], t.[IS_LOCKED], t.[LOCKOUT_END_DATE], t.[TWO_FACTOR_ENABLED], t.[PREFERRED_NOTIFICATION_METHOD], t.[STATUS], t.[CREATED_DATE] \r\n\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[USER_ID],\r\n\t\t    count(*) as __$count_BA7D5A31 \r\n\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[USER_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock) where  ( (c.[USER_ID] = t.[USER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[USER_ID] = m.[USER_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[USER_ID] = t.[USER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[DIGITAL_DIGITAL_USERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[USER_ID] = mo.[USER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BA7D5A31\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BA7D5A31 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_BA7D5A31\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_BA7D5A31 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [USER_ID], [CUSTOMER_ID], [USERNAME], [PASSWORD_HASH], [EMAIL], [MOBILE_PHONE], [LAST_LOGIN_DATE], [LOGIN_ATTEMPTS], [IS_LOCKED], [LOCKOUT_END_DATE], [TWO_FACTOR_ENABLED], [PREFERRED_NOTIFICATION_METHOD], [STATUS], [CREATED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BA7D5A31 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[USER_ID] = t.[USER_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BA7D5A31, __$count_BA7D5A31, \r\n\t\tm.__$update_mask , t.[USER_ID], t.[CUSTOMER_ID], t.[USERNAME], t.[PASSWORD_HASH], t.[EMAIL], t.[MOBILE_PHONE], t.[LAST_LOGIN_DATE], t.[LOGIN_ATTEMPTS], t.[IS_LOCKED], t.[LOCKOUT_END_DATE], t.[TWO_FACTOR_ENABLED], t.[PREFERRED_NOTIFICATION_METHOD], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[USER_ID],\r\n\t\t    count(*) as __$count_BA7D5A31, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[USER_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock) where  ( (c.[USER_ID] = t.[USER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[USER_ID] = m.[USER_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[USER_ID] = t.[USER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[DIGITAL_DIGITAL_USERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[USER_ID] = mo.[USER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[USER_ID], t.[CUSTOMER_ID], t.[USERNAME], t.[PASSWORD_HASH], t.[EMAIL], t.[MOBILE_PHONE], t.[LAST_LOGIN_DATE], t.[LOGIN_ATTEMPTS], t.[IS_LOCKED], t.[LOCKOUT_END_DATE], t.[TWO_FACTOR_ENABLED], t.[PREFERRED_NOTIFICATION_METHOD], t.[STATUS], t.[CREATED_DATE]\r\n\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'DIGITAL_DIGITAL_USERS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock) where  ( (c.[USER_ID] = t.[USER_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[DIGITAL_DIGITAL_USERS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[USER_ID] = t.[USER_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[DIGITAL_DIGITAL_USERS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[USER_ID] = mo.[USER_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f8": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f8","name":"cdc.fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_PAYMENTS_TRANSACTIONS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [TRANSACTION_ID], NULL as [INSTITUTION_ID], NULL as [NETWORK_ID], NULL as [TRANSACTION_NUMBER], NULL as [PAYMENT_TYPE], NULL as [DEBIT_ACCOUNT_ID], NULL as [CREDIT_ACCOUNT_ID], NULL as [EXTERNAL_ACCOUNT_NUMBER], NULL as [EXTERNAL_ROUTING_NUMBER], NULL as [EXTERNAL_BANK_NAME], NULL as [AMOUNT], NULL as [CURRENCY], NULL as [TRANSACTION_DATE], NULL as [EFFECTIVE_DATE], NULL as [SETTLEMENT_DATE], NULL as [STATUS], NULL as [STATUS_REASON], NULL as [DESCRIPTION], NULL as [REFERENCE], NULL as [PROCESSING_FEE], NULL as [RISK_SCORE], NULL as [FRAUD_FLAG], NULL as [COMPLIANCE_FLAG], NULL as [CREATED_DATE], NULL as [MODIFIED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_219BB418\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [TRANSACTION_ID], [INSTITUTION_ID], [NETWORK_ID], [TRANSACTION_NUMBER], [PAYMENT_TYPE], [DEBIT_ACCOUNT_ID], [CREDIT_ACCOUNT_ID], [EXTERNAL_ACCOUNT_NUMBER], [EXTERNAL_ROUTING_NUMBER], [EXTERNAL_BANK_NAME], [AMOUNT], [CURRENCY], [TRANSACTION_DATE], [EFFECTIVE_DATE], [SETTLEMENT_DATE], [STATUS], [STATUS_REASON], [DESCRIPTION], [REFERENCE], [PROCESSING_FEE], [RISK_SCORE], [FRAUD_FLAG], [COMPLIANCE_FLAG], [CREATED_DATE], [MODIFIED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_219BB418 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_219BB418, __$count_219BB418, t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE] \r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[TRANSACTION_ID],\r\n\t\t    count(*) as __$count_219BB418 \r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[TRANSACTION_ID] = m.[TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_219BB418\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_219BB418\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_219BB418 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [TRANSACTION_ID], [INSTITUTION_ID], [NETWORK_ID], [TRANSACTION_NUMBER], [PAYMENT_TYPE], [DEBIT_ACCOUNT_ID], [CREDIT_ACCOUNT_ID], [EXTERNAL_ACCOUNT_NUMBER], [EXTERNAL_ROUTING_NUMBER], [EXTERNAL_BANK_NAME], [AMOUNT], [CURRENCY], [TRANSACTION_DATE], [EFFECTIVE_DATE], [SETTLEMENT_DATE], [STATUS], [STATUS_REASON], [DESCRIPTION], [REFERENCE], [PROCESSING_FEE], [RISK_SCORE], [FRAUD_FLAG], [COMPLIANCE_FLAG], [CREATED_DATE], [MODIFIED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_219BB418 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_219BB418, __$count_219BB418, \r\n\t\tm.__$update_mask , t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[TRANSACTION_ID],\r\n\t\t    count(*) as __$count_219BB418, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[TRANSACTION_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[TRANSACTION_ID] = m.[TRANSACTION_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[TRANSACTION_ID], t.[INSTITUTION_ID], t.[NETWORK_ID], t.[TRANSACTION_NUMBER], t.[PAYMENT_TYPE], t.[DEBIT_ACCOUNT_ID], t.[CREDIT_ACCOUNT_ID], t.[EXTERNAL_ACCOUNT_NUMBER], t.[EXTERNAL_ROUTING_NUMBER], t.[EXTERNAL_BANK_NAME], t.[AMOUNT], t.[CURRENCY], t.[TRANSACTION_DATE], t.[EFFECTIVE_DATE], t.[SETTLEMENT_DATE], t.[STATUS], t.[STATUS_REASON], t.[DESCRIPTION], t.[REFERENCE], t.[PROCESSING_FEE], t.[RISK_SCORE], t.[FRAUD_FLAG], t.[COMPLIANCE_FLAG], t.[CREATED_DATE], t.[MODIFIED_DATE]\r\n\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_TRANSACTIONS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock) where  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_TRANSACTIONS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[TRANSACTION_ID] = t.[TRANSACTION_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_TRANSACTIONS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[TRANSACTION_ID] = mo.[TRANSACTION_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"t6": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-251","object_id":"column-251","name":"TRANSACTION_ID","name_without_path":"TRANSACTION_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-250","object_id":"column-250","name":"INSTITUTION_ID","name_without_path":"INSTITUTION_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t7","name":"CORE.FINANCIAL_INSTITUTIONS","name_show_schema":"CORE.FINANCIAL_INSTITUTIONS"}],"linked_lookup":null},{"id":"column-249","object_id":"column-249","name":"NETWORK_ID","name_without_path":"NETWORK_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t21","name":"PAYMENTS.PAYMENT_NETWORKS","name_show_schema":"PAYMENTS.PAYMENT_NETWORKS"}],"linked_lookup":null},{"id":"column-248","object_id":"column-248","name":"TRANSACTION_NUMBER","name_without_path":"TRANSACTION_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-247","object_id":"column-247","name":"PAYMENT_TYPE","name_without_path":"PAYMENT_TYPE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-16","object_id":"column-16","name":"DEBIT_ACCOUNT_ID","name_without_path":"DEBIT_ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t18","name":"CORE.ACCOUNTS","name_show_schema":"CORE.ACCOUNTS"}],"linked_lookup":null},{"id":"column-15","object_id":"column-15","name":"CREDIT_ACCOUNT_ID","name_without_path":"CREDIT_ACCOUNT_ID","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[{"id":"t18","name":"CORE.ACCOUNTS","name_show_schema":"CORE.ACCOUNTS"}],"linked_lookup":null},{"id":"column-14","object_id":"column-14","name":"EXTERNAL_ACCOUNT_NUMBER","name_without_path":"EXTERNAL_ACCOUNT_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-13","object_id":"column-13","name":"EXTERNAL_ROUTING_NUMBER","name_without_path":"EXTERNAL_ROUTING_NUMBER","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"9","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-12","object_id":"column-12","name":"EXTERNAL_BANK_NAME","name_without_path":"EXTERNAL_BANK_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-11","object_id":"column-11","name":"AMOUNT","name_without_path":"AMOUNT","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"15, 2","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-10","object_id":"column-10","name":"CURRENCY","name_without_path":"CURRENCY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"3","is_nullable":true,"computed_formula":null,"default_value":"'USD'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-9","object_id":"column-9","name":"TRANSACTION_DATE","name_without_path":"TRANSACTION_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-8","object_id":"column-8","name":"EFFECTIVE_DATE","name_without_path":"EFFECTIVE_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-7","object_id":"column-7","name":"SETTLEMENT_DATE","name_without_path":"SETTLEMENT_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"date","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-6","object_id":"column-6","name":"STATUS","name_without_path":"STATUS","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":true,"computed_formula":null,"default_value":"'Pending'","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-5","object_id":"column-5","name":"STATUS_REASON","name_without_path":"STATUS_REASON","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"200","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-4","object_id":"column-4","name":"DESCRIPTION","name_without_path":"DESCRIPTION","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"500","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-3","object_id":"column-3","name":"REFERENCE","name_without_path":"REFERENCE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-2","object_id":"column-2","name":"PROCESSING_FEE","name_without_path":"PROCESSING_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-1","object_id":"column-1","name":"RISK_SCORE","name_without_path":"RISK_SCORE","description":null,"is_pk":false,"is_identity":false,"data_type":"int","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-179","object_id":"column-179","name":"FRAUD_FLAG","name_without_path":"FRAUD_FLAG","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-178","object_id":"column-178","name":"COMPLIANCE_FLAG","name_without_path":"COMPLIANCE_FLAG","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-177","object_id":"column-177","name":"CREATED_DATE","name_without_path":"CREATED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-185","object_id":"column-185","name":"MODIFIED_DATE","name_without_path":"MODIFIED_DATE","description":null,"is_pk":false,"is_identity":false,"data_type":"datetime2","data_length":"7","is_nullable":true,"computed_formula":null,"default_value":"getdate()","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_TRANSACTIONS_DEBIT_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"DEBIT_ACCOUNT_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_CREDIT_ACCOUNT","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.ACCOUNTS","primary_table_show_schema":"CORE.ACCOUNTS","primary_table_verbose":"CORE.ACCOUNTS","primary_table_verbose_show_schema":"CORE.ACCOUNTS","primary_table_object_id":"t18","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"ACCOUNT_ID","foreign_column_path":null,"foreign_column":"CREDIT_ACCOUNT_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_INSTITUTION","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"CORE.FINANCIAL_INSTITUTIONS","primary_table_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose":"CORE.FINANCIAL_INSTITUTIONS","primary_table_verbose_show_schema":"CORE.FINANCIAL_INSTITUTIONS","primary_table_object_id":"t7","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"INSTITUTION_ID","foreign_column_path":null,"foreign_column":"INSTITUTION_ID"}],"custom_fields":{}},{"name":"FK_TRANSACTIONS_NETWORK","title":null,"description":null,"is_user_defined":false,"foreign_table":"PAYMENTS.TRANSACTIONS","foreign_table_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_verbose":"PAYMENTS.TRANSACTIONS","foreign_table_verbose_show_schema":"PAYMENTS.TRANSACTIONS","foreign_table_object_id":"t6","primary_table":"PAYMENTS.PAYMENT_NETWORKS","primary_table_show_schema":"PAYMENTS.PAYMENT_NETWORKS","primary_table_verbose":"PAYMENTS.PAYMENT_NETWORKS","primary_table_verbose_show_schema":"PAYMENTS.PAYMENT_NETWORKS","primary_table_object_id":"t21","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"NETWORK_ID","foreign_column_path":null,"foreign_column":"NETWORK_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_TRANSACTIONS","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"TRANSACTION_ID","name":"TRANSACTION_ID","column_id":251}],"custom_fields":{}},{"name":"UQ_TRANSACTIONS_NUMBER","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"INSTITUTION_ID","name":"INSTITUTION_ID","column_id":250},{"path":null,"name_without_path":"TRANSACTION_NUMBER","name":"TRANSACTION_NUMBER","column_id":248}],"custom_fields":{}}],"triggers":[{"name":"TR_PAYMENTS_TRANSACTIONS_CHANGE","description":null,"action":"After Insert Update Delete ","script":"-- =============================================================================\r\n-- FIXED TRIGGERS FOR CRITICAL TABLES\r\n-- =============================================================================\r\n\r\n-- High-priority trigger for PAYMENTS.TRANSACTIONS (real-time processing)\r\nCREATE   TRIGGER TR_PAYMENTS_TRANSACTIONS_CHANGE\r\nON PAYMENTS.TRANSACTIONS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @operation NVARCHAR(10);\r\n    \r\n    IF EXISTS(SELECT * FROM inserted) AND EXISTS(SELECT * FROM deleted)\r\n        SET @operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT * FROM inserted)\r\n        SET @operation = 'INSERT'\r\n    ELSE\r\n        SET @operation = 'DELETE';\r\n    \r\n    -- Log payment transaction changes (HIGH priority for real-time fraud detection)\r\n    IF @operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'PAYMENTS', 'TRANSACTIONS', 'INSERT', \r\n            CAST(TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN AMOUNT >= 10000 OR FRAUD_FLAG = 1 THEN 'HIGH'\r\n                WHEN AMOUNT >= 1000 THEN 'MEDIUM'\r\n                ELSE 'LOW'\r\n            END,\r\n            (SELECT \r\n                outer_ins.TRANSACTION_ID,\r\n                outer_ins.INSTITUTION_ID,\r\n                outer_ins.TRANSACTION_NUMBER,\r\n                outer_ins.PAYMENT_TYPE,\r\n                outer_ins.AMOUNT,\r\n                outer_ins.CURRENCY,\r\n                outer_ins.TRANSACTION_DATE,\r\n                outer_ins.STATUS,\r\n                outer_ins.FRAUD_FLAG,\r\n                outer_ins.RISK_SCORE\r\n             FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n        FROM inserted outer_ins;\r\n    END\r\n    \r\n    IF @operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'PAYMENTS', 'TRANSACTIONS', 'UPDATE', \r\n            CAST(i.TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(i.TRANSACTION_DATE AS DATE),\r\n            CASE \r\n                WHEN i.FRAUD_FLAG = 1 OR i.STATUS = 'Failed' THEN 'HIGH'\r\n                ELSE 'MEDIUM'\r\n            END,\r\n            CONCAT(\r\n                '{\"operation\":\"UPDATE\",\"old_values\":',\r\n                (SELECT \r\n                    d.TRANSACTION_ID,\r\n                    d.STATUS,\r\n                    d.AMOUNT,\r\n                    d.FRAUD_FLAG,\r\n                    d.RISK_SCORE\r\n                 FROM deleted d \r\n                 WHERE d.TRANSACTION_ID = i.TRANSACTION_ID \r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                ',\"new_values\":',\r\n                (SELECT \r\n                    i.TRANSACTION_ID,\r\n                    i.STATUS,\r\n                    i.AMOUNT,\r\n                    i.FRAUD_FLAG,\r\n                    i.RISK_SCORE\r\n                 FOR JSON PATH, WITHOUT_ARRAY_WRAPPER),\r\n                '}'\r\n            )\r\n        FROM inserted i;\r\n    END\r\n    \r\n    IF @operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO ADF_CONTROL.CHANGE_LOG (\r\n            TABLE_SCHEMA, TABLE_NAME, OPERATION_TYPE, RECORD_ID, \r\n            BUSINESS_DATE, PRIORITY_LEVEL, CHANGE_DATA\r\n        )\r\n        SELECT \r\n            'PAYMENTS', 'TRANSACTIONS', 'DELETE', \r\n            CAST(TRANSACTION_ID AS NVARCHAR(100)),\r\n            CAST(TRANSACTION_DATE AS DATE),\r\n            'MEDIUM',\r\n            (SELECT \r\n                outer_del.TRANSACTION_ID,\r\n                outer_del.INSTITUTION_ID,\r\n                outer_del.TRANSACTION_NUMBER,\r\n                outer_del.PAYMENT_TYPE,\r\n                outer_del.AMOUNT,\r\n                outer_del.STATUS\r\n             FOR JSON PATH, WITHOUT_ARRAY_WRAPPER)\r\n        FROM deleted outer_del;\r\n    END\r\nEND;","custom_fields":{}},{"name":"TR_TRANSACTIONS_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_TRANSACTIONS_EventLog\r\nON PAYMENTS.TRANSACTIONS\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'TRANSACTIONS',\r\n            'INSERT',\r\n            CAST(TRANSACTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.TRANSACTION_ID = inserted.TRANSACTION_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'TRANSACTIONS',\r\n            'UPDATE',\r\n            CAST(i.TRANSACTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.TRANSACTION_ID = i.TRANSACTION_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.TRANSACTION_ID = i.TRANSACTION_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'PAYMENTS',\r\n            'TRANSACTIONS',\r\n            'DELETE',\r\n            CAST(TRANSACTION_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.TRANSACTION_ID = deleted.TRANSACTION_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"PAYMENTS.TRANSACTIONS","object_name_show_schema":"PAYMENTS.TRANSACTIONS","object_type":"TABLE","object_id":"t6","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"CORE.FINANCIAL_INSTITUTIONS","object_name_show_schema":"CORE.FINANCIAL_INSTITUTIONS","object_type":"TABLE","object_id":"t7","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"PAYMENTS.PAYMENT_NETWORKS","object_name_show_schema":"PAYMENTS.PAYMENT_NETWORKS","object_type":"TABLE","object_id":"t21","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]},{"object_name":"PAYMENTS.TR_PAYMENTS_TRANSACTIONS_CHANGE","object_name_show_schema":"PAYMENTS.TR_PAYMENTS_TRANSACTIONS_CHANGE","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]},{"object_name":"PAYMENTS.TR_TRANSACTIONS_EventLog","object_name_show_schema":"PAYMENTS.TR_TRANSACTIONS_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[]},"object_id":"t6","name":"PAYMENTS.TRANSACTIONS","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"PAYMENTS"},{"field":"Name","value":"TRANSACTIONS"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"t9": {"columns_custom_fields":[],"relations_custom_fields":[],"unique_keys_custom_fields":[],"triggers_custom_fields":[],"columns":[{"id":"column-96","object_id":"column-96","name":"PRODUCT_TYPE_ID","name_without_path":"PRODUCT_TYPE_ID","description":null,"is_pk":true,"is_identity":true,"data_type":"int","data_length":null,"is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-95","object_id":"column-95","name":"PRODUCT_CODE","name_without_path":"PRODUCT_CODE","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"20","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-94","object_id":"column-94","name":"PRODUCT_NAME","name_without_path":"PRODUCT_NAME","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"100","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-93","object_id":"column-93","name":"PRODUCT_CATEGORY","name_without_path":"PRODUCT_CATEGORY","description":null,"is_pk":false,"is_identity":false,"data_type":"varchar","data_length":"50","is_nullable":false,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-92","object_id":"column-92","name":"INTEREST_RATE","name_without_path":"INTEREST_RATE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"5, 4","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-91","object_id":"column-91","name":"MINIMUM_BALANCE","name_without_path":"MINIMUM_BALANCE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"12, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-90","object_id":"column-90","name":"MONTHLY_FEE","name_without_path":"MONTHLY_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":"0","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-89","object_id":"column-89","name":"OVERDRAFT_FEE","name_without_path":"OVERDRAFT_FEE","description":null,"is_pk":false,"is_identity":false,"data_type":"decimal","data_length":"8, 2","is_nullable":true,"computed_formula":null,"default_value":null,"path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null},{"id":"column-88","object_id":"column-88","name":"IS_ACTIVE","name_without_path":"IS_ACTIVE","description":null,"is_pk":false,"is_identity":false,"data_type":"bit","data_length":null,"is_nullable":true,"computed_formula":null,"default_value":"1","path":null,"level":1,"item_type":"COLUMN","is_user_defined":false,"custom_fields":{},"linked_terms":[],"references":[],"linked_lookup":null}],"relations":[{"name":"FK_ACCOUNTS_PRODUCT_TYPE","title":null,"description":null,"is_user_defined":false,"foreign_table":"CORE.ACCOUNTS","foreign_table_show_schema":"CORE.ACCOUNTS","foreign_table_verbose":"CORE.ACCOUNTS","foreign_table_verbose_show_schema":"CORE.ACCOUNTS","foreign_table_object_id":"t18","primary_table":"CORE.PRODUCT_TYPES","primary_table_show_schema":"CORE.PRODUCT_TYPES","primary_table_verbose":"CORE.PRODUCT_TYPES","primary_table_verbose_show_schema":"CORE.PRODUCT_TYPES","primary_table_object_id":"t9","pk_cardinality":"1x","fk_cardinality":"mx","constraints":[{"primary_column_path":null,"primary_column":"PRODUCT_TYPE_ID","foreign_column_path":null,"foreign_column":"PRODUCT_TYPE_ID"}],"custom_fields":{}}],"unique_keys":[{"name":"PK_PRODUCT_TYPES","description":null,"is_pk":true,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"PRODUCT_TYPE_ID","name":"PRODUCT_TYPE_ID","column_id":96}],"custom_fields":{}},{"name":"UQ_PRODUCT_TYPES_CODE","description":null,"is_pk":false,"is_user_defined":false,"columns":[{"path":null,"name_without_path":"PRODUCT_CODE","name":"PRODUCT_CODE","column_id":95}],"custom_fields":{}}],"triggers":[{"name":"TR_PRODUCT_TYPES_EventLog","description":null,"action":"After Insert Update Delete ","script":"CREATE TRIGGER TR_PRODUCT_TYPES_EventLog\r\nON CORE.PRODUCT_TYPES\r\nAFTER INSERT, UPDATE, DELETE\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n    \r\n    DECLARE @Operation NVARCHAR(10)\r\n    \r\n    IF EXISTS(SELECT 1 FROM inserted) AND EXISTS(SELECT 1 FROM deleted)\r\n        SET @Operation = 'UPDATE'\r\n    ELSE IF EXISTS(SELECT 1 FROM inserted)\r\n        SET @Operation = 'INSERT'\r\n    ELSE\r\n        SET @Operation = 'DELETE'\r\n    \r\n    IF @Operation = 'INSERT'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'PRODUCT_TYPES',\r\n            'INSERT',\r\n            CAST(PRODUCT_TYPE_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM inserted i WHERE i.PRODUCT_TYPE_ID = inserted.PRODUCT_TYPE_ID FOR JSON AUTO)\r\n        FROM inserted\r\n    END\r\n    \r\n    IF @Operation = 'UPDATE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues, NewValues)\r\n        SELECT \r\n            'CORE',\r\n            'PRODUCT_TYPES',\r\n            'UPDATE',\r\n            CAST(i.PRODUCT_TYPE_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.PRODUCT_TYPE_ID = i.PRODUCT_TYPE_ID FOR JSON AUTO),\r\n            (SELECT * FROM inserted ins WHERE ins.PRODUCT_TYPE_ID = i.PRODUCT_TYPE_ID FOR JSON AUTO)\r\n        FROM inserted i\r\n    END\r\n    \r\n    IF @Operation = 'DELETE'\r\n    BEGIN\r\n        INSERT INTO dbo.EventLog (SchemaName, TableName, Operation, RecordID, OldValues)\r\n        SELECT \r\n            'CORE',\r\n            'PRODUCT_TYPES',\r\n            'DELETE',\r\n            CAST(PRODUCT_TYPE_ID AS NVARCHAR(50)),\r\n            (SELECT * FROM deleted d WHERE d.PRODUCT_TYPE_ID = deleted.PRODUCT_TYPE_ID FOR JSON AUTO)\r\n        FROM deleted\r\n    END\r\nEND","custom_fields":{}}],"dependencies":{"uses":[{"object_name":"CORE.TR_PRODUCT_TYPES_EventLog","object_name_show_schema":"CORE.TR_PRODUCT_TYPES_EventLog","object_type":"TRIGGER","type":"TRIGGER","object_user_defined":false,"user_defined":false,"children":[]}],"used_by":[{"object_name":"CORE.PRODUCT_TYPES","object_name_show_schema":"CORE.PRODUCT_TYPES","object_type":"TABLE","object_id":"t9","type":"NORMAL","object_user_defined":false,"user_defined":false,"children":[{"object_name":"CORE.ACCOUNTS","object_name_show_schema":"CORE.ACCOUNTS","object_type":"TABLE","object_id":"t18","type":"RELATION","pk_cardinality":"1x","fk_cardinality":"mx","object_user_defined":false,"user_defined":false,"children":[]}]}]},"object_id":"t9","name":"CORE.PRODUCT_TYPES","subtype":"TABLE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"CORE"},{"field":"Name","value":"PRODUCT_TYPES"},{"field":"Type","value":"Table"}],"script":null,"imported_at":"2025-07-03 21:41"},"f4": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f4","name":"cdc.fn_cdc_get_all_changes_COMPLIANCE_SANCTIONS_SCREENING","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_all_changes_COMPLIANCE_SANCTIONS_SCREENING"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_all_changes_COMPLIANCE_SANCTIONS_SCREENING]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\t\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$seqval,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [SCREENING_ID], NULL as [CUSTOMER_ID], NULL as [TRANSACTION_ID], NULL as [ENTITY_NAME], NULL as [SCREENING_TYPE], NULL as [MATCH_TYPE], NULL as [MATCH_SCORE], NULL as [LIST_NAME], NULL as [STATUS], NULL as [REVIEW_NOTES], NULL as [SCREENING_DATE], NULL as [REVIEWED_BY], NULL as [REVIEWED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[SCREENING_ID], t.[CUSTOMER_ID], t.[TRANSACTION_ID], t.[ENTITY_NAME], t.[SCREENING_TYPE], t.[MATCH_TYPE], t.[MATCH_SCORE], t.[LIST_NAME], t.[STATUS], t.[REVIEW_NOTES], t.[SCREENING_DATE], t.[REVIEWED_BY], t.[REVIEWED_DATE]\r\n\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] t with (nolock)    \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4)\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\r\n\tunion all\t\r\n\t\t\r\n\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tt.__$seqval as __$seqval,\r\n\t\tt.__$operation as __$operation,\r\n\t\tt.__$update_mask as __$update_mask, t.[SCREENING_ID], t.[CUSTOMER_ID], t.[TRANSACTION_ID], t.[ENTITY_NAME], t.[SCREENING_TYPE], t.[MATCH_TYPE], t.[MATCH_SCORE], t.[LIST_NAME], t.[STATUS], t.[REVIEW_NOTES], t.[SCREENING_DATE], t.[REVIEWED_BY], t.[REVIEWED_DATE]\r\n\tfrom [cdc].[COMPLIANCE_SANCTIONS_SCREENING_CT] t with (nolock)     \r\n\twhere (lower(rtrim(ltrim(@row_filter_option))) = 'all update old')\r\n\t    and ( [sys].[fn_cdc_check_parameters]( N'COMPLIANCE_SANCTIONS_SCREENING', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 0) = 1)\r\n\t\tand (t.__$operation = 1 or t.__$operation = 2 or t.__$operation = 4 or\r\n\t\t     t.__$operation = 3 )\r\n\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\tand (t.__$start_lsn >= @from_lsn)","imported_at":"2025-07-03 21:41"},"f13": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f13","name":"cdc.fn_cdc_get_net_changes_PAYMENTS_PAYMENT_NETWORKS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_PAYMENTS_PAYMENT_NETWORKS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_PAYMENTS_PAYMENT_NETWORKS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [NETWORK_ID], NULL as [NETWORK_CODE], NULL as [NETWORK_NAME], NULL as [NETWORK_TYPE], NULL as [PROCESSING_FEE], NULL as [SETTLEMENT_TIME], NULL as [MAX_TRANSACTION_AMOUNT], NULL as [IS_ACTIVE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BA36135E\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BA36135E \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [NETWORK_ID], [NETWORK_CODE], [NETWORK_NAME], [NETWORK_TYPE], [PROCESSING_FEE], [SETTLEMENT_TIME], [MAX_TRANSACTION_AMOUNT], [IS_ACTIVE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BA36135E \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BA36135E, __$count_BA36135E, t.[NETWORK_ID], t.[NETWORK_CODE], t.[NETWORK_NAME], t.[NETWORK_TYPE], t.[PROCESSING_FEE], t.[SETTLEMENT_TIME], t.[MAX_TRANSACTION_AMOUNT], t.[IS_ACTIVE] \r\n\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[NETWORK_ID],\r\n\t\t    count(*) as __$count_BA36135E \r\n\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[NETWORK_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock) where  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[NETWORK_ID] = m.[NETWORK_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[NETWORK_ID] = mo.[NETWORK_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_BA36135E\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_BA36135E \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_BA36135E\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_BA36135E \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [NETWORK_ID], [NETWORK_CODE], [NETWORK_NAME], [NETWORK_TYPE], [PROCESSING_FEE], [SETTLEMENT_TIME], [MAX_TRANSACTION_AMOUNT], [IS_ACTIVE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_BA36135E \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_BA36135E, __$count_BA36135E, \r\n\t\tm.__$update_mask , t.[NETWORK_ID], t.[NETWORK_CODE], t.[NETWORK_NAME], t.[NETWORK_TYPE], t.[PROCESSING_FEE], t.[SETTLEMENT_TIME], t.[MAX_TRANSACTION_AMOUNT], t.[IS_ACTIVE]\r\n\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[NETWORK_ID],\r\n\t\t    count(*) as __$count_BA36135E, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[NETWORK_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock) where  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[NETWORK_ID] = m.[NETWORK_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[NETWORK_ID] = mo.[NETWORK_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[NETWORK_ID], t.[NETWORK_CODE], t.[NETWORK_NAME], t.[NETWORK_TYPE], t.[PROCESSING_FEE], t.[SETTLEMENT_TIME], t.[MAX_TRANSACTION_AMOUNT], t.[IS_ACTIVE]\r\n\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'PAYMENTS_PAYMENT_NETWORKS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock) where  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[NETWORK_ID] = t.[NETWORK_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[PAYMENTS_PAYMENT_NETWORKS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[NETWORK_ID] = mo.[NETWORK_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},"f10": {"parameters":[{"name":"Returns","description":null,"mode":"OUT","data_type":"table type","custom_fields":{},"linked_terms":[]},{"name":"from_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"to_lsn","description":null,"mode":"IN","data_type":"binary(10)","custom_fields":{},"linked_terms":[]},{"name":"row_filter_option","description":null,"mode":"IN","data_type":"nvarchar(30)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"f10","name":"cdc.fn_cdc_get_net_changes_RISK_RISK_EVENTS","subtype":"FUNCTION","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"db_azure_ff_demo@db-server-ff-demo.database.windows.net","id":"d1"}},{"field":"Schema","value":"cdc"},{"field":"Name","value":"fn_cdc_get_net_changes_RISK_RISK_EVENTS"},{"field":"Type","value":"Function"}],"script":"create function [cdc].[fn_cdc_get_net_changes_RISK_RISK_EVENTS]\r\n\t(\t@from_lsn binary(10),\r\n\t\t@to_lsn binary(10),\r\n\t\t@row_filter_option nvarchar(30)\r\n\t)\r\n\treturns table\r\n\treturn\r\n\r\n\tselect NULL as __$start_lsn,\r\n\t\tNULL as __$operation,\r\n\t\tNULL as __$update_mask, NULL as [EVENT_ID], NULL as [RULE_ID], NULL as [INSTITUTION_ID], NULL as [CUSTOMER_ID], NULL as [ACCOUNT_ID], NULL as [TRANSACTION_ID], NULL as [CARD_TRANSACTION_ID], NULL as [EVENT_TYPE], NULL as [EVENT_DESCRIPTION], NULL as [RISK_SCORE], NULL as [SEVERITY], NULL as [STATUS], NULL as [ASSIGNED_TO], NULL as [RESOLUTION_NOTES], NULL as [EVENT_DATE], NULL as [RESOLVED_DATE]\r\n\twhere ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 0)\r\n\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_7AD0A582\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_7AD0A582 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , [EVENT_ID], [RULE_ID], [INSTITUTION_ID], [CUSTOMER_ID], [ACCOUNT_ID], [TRANSACTION_ID], [CARD_TRANSACTION_ID], [EVENT_TYPE], [EVENT_DESCRIPTION], [RISK_SCORE], [SEVERITY], [STATUS], [ASSIGNED_TO], [RESOLUTION_NOTES], [EVENT_DATE], [RESOLVED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_7AD0A582 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] c with (nolock)   \r\n\t\t\twhere  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_7AD0A582, __$count_7AD0A582, t.[EVENT_ID], t.[RULE_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[ACCOUNT_ID], t.[TRANSACTION_ID], t.[CARD_TRANSACTION_ID], t.[EVENT_TYPE], t.[EVENT_DESCRIPTION], t.[RISK_SCORE], t.[SEVERITY], t.[STATUS], t.[ASSIGNED_TO], t.[RESOLUTION_NOTES], t.[EVENT_DATE], t.[RESOLVED_DATE] \r\n\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[EVENT_ID],\r\n\t\t    count(*) as __$count_7AD0A582 \r\n\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[EVENT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[RISK_RISK_EVENTS_CT] c with (nolock) where  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[EVENT_ID] = m.[EVENT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] c with (nolock) \r\n\t\t\t\t\t\t\twhere  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[RISK_RISK_EVENTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[EVENT_ID] = mo.[EVENT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\tselect __$start_lsn,\r\n\t    case __$count_7AD0A582\r\n\t    when 1 then __$operation\r\n\t    else\r\n\t\t\tcase __$min_op_7AD0A582 \r\n\t\t\t\twhen 2 then 2\r\n\t\t\t\twhen 4 then\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 1 then 1\r\n\t\t\t\t\telse 4\r\n\t\t\t\t\tend\r\n\t\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\t\twhen 2 then 4\r\n\t\t\t\t\twhen 4 then 4\r\n\t\t\t\t\telse 1\r\n\t\t\t\t\tend\r\n\t\t\tend\r\n\t\tend as __$operation,\r\n\t\tcase __$count_7AD0A582\r\n\t\twhen 1 then\r\n\t\t\tcase __$operation\r\n\t\t\twhen 4 then __$update_mask\r\n\t\t\telse null\r\n\t\t\tend\r\n\t\telse\t\r\n\t\t\tcase __$min_op_7AD0A582 \r\n\t\t\twhen 2 then null\r\n\t\t\telse\r\n\t\t\t\tcase __$operation\r\n\t\t\t\twhen 1 then null\r\n\t\t\t\telse __$update_mask \r\n\t\t\t\tend\r\n\t\t\tend\t\r\n\t\tend as __$update_mask , [EVENT_ID], [RULE_ID], [INSTITUTION_ID], [CUSTOMER_ID], [ACCOUNT_ID], [TRANSACTION_ID], [CARD_TRANSACTION_ID], [EVENT_TYPE], [EVENT_DESCRIPTION], [RISK_SCORE], [SEVERITY], [STATUS], [ASSIGNED_TO], [RESOLUTION_NOTES], [EVENT_DATE], [RESOLVED_DATE]\r\n\tfrom\r\n\t(\r\n\t\tselect t.__$start_lsn as __$start_lsn, __$operation,\r\n\t\tcase __$count_7AD0A582 \r\n\t\twhen 1 then __$operation \r\n\t\telse\r\n\t\t(\tselect top 1 c.__$operation\r\n\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] c with (nolock)\r\n\t\t\twhere  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  \r\n\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval) end __$min_op_7AD0A582, __$count_7AD0A582, \r\n\t\tm.__$update_mask , t.[EVENT_ID], t.[RULE_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[ACCOUNT_ID], t.[TRANSACTION_ID], t.[CARD_TRANSACTION_ID], t.[EVENT_TYPE], t.[EVENT_DESCRIPTION], t.[RISK_SCORE], t.[SEVERITY], t.[STATUS], t.[ASSIGNED_TO], t.[RESOLUTION_NOTES], t.[EVENT_DATE], t.[RESOLVED_DATE]\r\n\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] t with (nolock) inner join \r\n\t\t(\tselect  r.[EVENT_ID],\r\n\t\t    count(*) as __$count_7AD0A582, \r\n\t\t    [sys].[ORMask](r.__$update_mask) as __$update_mask\r\n\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] r with (nolock)\r\n\t\t\twhere  (r.__$start_lsn <= @to_lsn)\r\n\t\t\tand (r.__$start_lsn >= @from_lsn)\r\n\t\t\tgroup by   r.[EVENT_ID]) m\r\n\t\ton t.__$seqval = ( select top 1 c.__$seqval from [cdc].[RISK_RISK_EVENTS_CT] c with (nolock) where  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ) and\r\n\t\t    ( (t.[EVENT_ID] = m.[EVENT_ID]) ) \t\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with mask'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and\r\n\t\t\t\t  (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t   )\r\n\t \t\t\t )\r\n\t \t\t\t) \r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[RISK_RISK_EVENTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[EVENT_ID] = mo.[EVENT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)\t\r\n\t) Q\r\n\t\r\n\tunion all\r\n\t\r\n\t\tselect t.__$start_lsn as __$start_lsn,\r\n\t\tcase t.__$operation\r\n\t\t\twhen 1 then 1\r\n\t\t\telse 5\r\n\t\tend as __$operation,\r\n\t\tnull as __$update_mask , t.[EVENT_ID], t.[RULE_ID], t.[INSTITUTION_ID], t.[CUSTOMER_ID], t.[ACCOUNT_ID], t.[TRANSACTION_ID], t.[CARD_TRANSACTION_ID], t.[EVENT_TYPE], t.[EVENT_DESCRIPTION], t.[RISK_SCORE], t.[SEVERITY], t.[STATUS], t.[ASSIGNED_TO], t.[RESOLUTION_NOTES], t.[EVENT_DATE], t.[RESOLVED_DATE]\r\n\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] t  with (nolock)\r\n\t\twhere lower(rtrim(ltrim(@row_filter_option))) = N'all with merge'\r\n\t\t\tand ( [sys].[fn_cdc_check_parameters]( N'RISK_RISK_EVENTS', @from_lsn, @to_lsn, lower(rtrim(ltrim(@row_filter_option))), 1) = 1)\r\n\t\t\tand (t.__$start_lsn <= @to_lsn)\r\n\t\t\tand (t.__$start_lsn >= @from_lsn)\r\n\t\t\tand (t.__$seqval = ( select top 1 c.__$seqval from [cdc].[RISK_RISK_EVENTS_CT] c with (nolock) where  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  and c.__$start_lsn <= @to_lsn and c.__$start_lsn >= @from_lsn order by c.__$start_lsn desc, c.__$command_id desc, c.__$seqval desc ))\r\n\t\t\tand ((t.__$operation = 2) or (t.__$operation = 4) or \r\n\t\t\t\t ((t.__$operation = 1) and \r\n\t\t\t\t   (2 not in \r\n\t\t\t\t \t\t(\tselect top 1 c.__$operation\r\n\t\t\t\t\t\t\tfrom [cdc].[RISK_RISK_EVENTS_CT] c with (nolock)\r\n\t\t\t\t\t\t\twhere  ( (c.[EVENT_ID] = t.[EVENT_ID]) )  \r\n\t\t\t\t\t\t\tand ((c.__$operation = 2) or (c.__$operation = 4) or (c.__$operation = 1))\r\n\t\t\t\t\t\t\tand (c.__$start_lsn <= @to_lsn)\r\n\t\t\t\t\t\t\tand (c.__$start_lsn >= @from_lsn)\r\n\t\t\t\t\t\t\torder by c.__$start_lsn, c.__$command_id, c.__$seqval\r\n\t\t\t\t\t\t ) \r\n\t \t\t\t\t)\r\n\t \t\t\t )\r\n\t \t\t\t)\r\n\t\t\tand t.__$operation = (\r\n\t\t\t\tselect\r\n\t\t\t\t\tmax(mo.__$operation)\r\n\t\t\t\tfrom\r\n\t\t\t\t\t[cdc].[RISK_RISK_EVENTS_CT] as mo with (nolock)\r\n\t\t\t\twhere\r\n\t\t\t\t\tmo.__$seqval = t.__$seqval\r\n\t\t\t\t\tand \r\n\t\t\t\t\t ( (t.[EVENT_ID] = mo.[EVENT_ID]) ) \r\n\t\t\t\tgroup by\r\n\t\t\t\t\tmo.__$seqval\r\n\t\t\t)","imported_at":"2025-07-03 21:41"},}};